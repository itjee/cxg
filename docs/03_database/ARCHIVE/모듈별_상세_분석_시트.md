# 모듈별 상세 분석 시트

## 📌 목차
1. [01_ADM - 기본설정](#01_adm---기본설정)
2. [02_HRM - 인사관리](#02_hrm---인사관리)
3. [03_CRM - 거래처관리](#03_crm---거래처관리)
4. [04_PIM - 상품관리](#04_pim---상품관리)
5. [05_WMS - 창고관리](#05_wms---창고관리)
6. [06_APM - 결재관리](#06_apm---결재관리)
7. [10_IVM - 재고관리](#10_ivm---재고관리)
8. [11_PSM - 구매관리](#11_psm---구매관리)
9. [12_SRM - 판매관리](#12_srm---판매관리)
10. [13_ASM - 서비스관리](#13_asm---서비스관리)
11. [14_FIM - 재무관리](#14_fim---재무관리)
12. [15_FAM - 자산관리](#15_fam---자산관리)
13. [20_BIM - 분석관리](#20_bim---분석관리)
14. [21_COM - 공통설정](#21_com---공통설정)
15. [22_SYS - 시스템관리](#22_sys---시스템관리)

---

## 01_ADM - 기본설정

### 📊 현황
- **테이블 수**: 7개
- **완성도**: ⭐⭐⭐⭐⭐ (우수)
- **상태**: 안정적

### 📋 테이블 목록

| # | 테이블 | 목적 | 행 수 (예상) |
|---|--------|------|------------|
| 1 | `code_groups` | 공통코드 그룹 | 20-50 |
| 2 | `codes` | 공통코드 | 200-500 |
| 3 | `settings` | 시스템 설정 | 10-30 |
| 4 | `currencies` | 통화 정보 | 50-200 |
| 5 | `exchange_rates` | 환율 정보 | 5,000+ |
| 6 | `units` | 측정 단위 | 20-50 |

### ✅ 강점
- 기본 설정을 깔끔하게 분리
- 통화, 환율, 단위 관리 완벽
- 시스템 전역에서 참조

### 🔴 개선점
```
1. 결제 조건(Payment Terms) 마스터 부족
   - 현재: 문자열로 partners.payment_terms 관리
   - 개선: adm.payment_terms 또는 com.payment_terms 추가

2. 배송 조건(Delivery Terms) 마스터 부족
   - 현재: 문자열로 산발적 관리
   - 개선: adm.delivery_terms 추가
```

### 📝 권장 추가 테이블

**파일**: `01_adm/07_payment_terms.sql`
```sql
CREATE TABLE adm.payment_terms (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  code VARCHAR(20) NOT NULL UNIQUE, -- COD, NET7, NET15, NET30, PREPAID
  name VARCHAR(100) NOT NULL,
  days_to_pay INTEGER, -- NULL for COD, PREPAID
  is_active BOOLEAN DEFAULT true,
  description TEXT,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP,
  is_deleted BOOLEAN DEFAULT false
);
-- 예시 데이터:
-- COD, 착불, 0일
-- NET7, 7일 외상, 7일
-- NET30, 30일 외상, 30일
-- PREPAID, 선금, NULL
```

### 🎯 우선순위
- P3: 결제조건 마스터 추가 (낮음, 개선 차원)

---

## 02_HRM - 인사관리

### 📊 현황
- **테이블 수**: 8개 (+ 2개 필요)
- **완성도**: ⭐⭐⭐⭐ (좋음, 부족함)
- **상태**: 휴가/결근 관리 필요

### 📋 테이블 목록

| # | 테이블 | 목적 | 비고 |
|---|--------|------|------|
| 1 | `departments` | 부서 관리 | ✅ |
| 2 | `employees` | 직원 기본정보 | ✅ |
| 3 | `department_histories` | 부서 이력 | ✅ |
| 4 | `employee_histories` | 직원 이력 | ✅ |
| 5 | `salary_structures` | 급여 구조 | ✅ |
| 6 | `payroll_records` | 급여 기록 | ✅ |
| 7 | `attendances` | 출근 기록 | ⚠️ 부분만 |
| 8 | `absences` | **결근/휴가** | 🔴 **필수 추가** |
| 9 | `leave_policies` | **휴가 정책** | 🔴 **필수 추가** |

### ✅ 강점
- 완벽한 직원 기본정보 관리
- 급여 구조 및 급여 기록 관리
- 부서 이력 추적

### 🔴 심각한 부족점

#### 1. 휴가/결근 관리 완전 부족
```
현황:
- hrm.attendances: 출근/퇴근 기록만
- 무엇이 없는가?
  ❌ 연차 휴가 관리
  ❌ 병가 관리
  ❌ 무급휴가 관리
  ❌ 휴직 관리
  ❌ 휴가 정책 관리

한국 근로법 미준수:
- 근로기준법 15조: 1년에 15일의 연차 제공
- 연차 유효기간: 2년
- 미사용 연차 보상금
```

#### 2. 급여 계산에 반영 불가
```
급여 계산 시 필요한 정보:
- 근무일수 계산 (휴가 제외)
- 시간급 직원 근로시간 계산 (지각, 결근 포함)
- 병가 처리 (무급/유급 판단)
- 휴직 급여 계산

현재 상태: 불가능
```

### 📝 필수 추가 테이블

**파일1**: `02_hrm/08_absences.sql`
```sql
CREATE TABLE hrm.absences (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  employee_id UUID NOT NULL REFERENCES hrm.employees(id) ON DELETE RESTRICT,
  absence_type VARCHAR(20) NOT NULL,
    -- ABSENCE: 결근, LATE: 지각, SICK: 병가, ANNUAL: 연차,
    -- UNPAID: 무급휴가, MATERNITY: 출산휴가, LEAVE: 휴직
  date_from DATE NOT NULL,
  date_to DATE NOT NULL,
  duration_hours INTEGER, -- NULL이면 전일, 숫자면 시간
  reason TEXT,
  attached_document_path VARCHAR(500), -- 진단서 등
  approved_by UUID REFERENCES hrm.employees(id) ON DELETE SET NULL,
  approval_date TIMESTAMP WITH TIME ZONE,
  status VARCHAR(20) NOT NULL DEFAULT 'DRAFT',
    -- DRAFT, SUBMITTED, APPROVED, REJECTED, CANCELLED
  rejection_reason TEXT,

  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP,
  created_by UUID,
  updated_at TIMESTAMP WITH TIME ZONE,
  updated_by UUID,
  is_deleted BOOLEAN DEFAULT false,

  CONSTRAINT ck_absences__type CHECK (absence_type IN (
    'ABSENCE', 'LATE', 'SICK', 'ANNUAL', 'UNPAID', 'MATERNITY', 'LEAVE'
  )),
  CONSTRAINT ck_absences__status CHECK (status IN (
    'DRAFT', 'SUBMITTED', 'APPROVED', 'REJECTED', 'CANCELLED'
  ))
);
```

**파일2**: `02_hrm/09_leave_policies.sql`
```sql
CREATE TABLE hrm.leave_policies (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  leave_type VARCHAR(20) NOT NULL UNIQUE,
    -- ANNUAL: 연차, SICK: 병가, MATERNITY: 출산휴가, UNPAID: 무급
  entitled_days_per_year INTEGER NOT NULL, -- 연간 부여 일수
  is_paid BOOLEAN NOT NULL DEFAULT true, -- 유급 여부
  validity_years INTEGER DEFAULT 2, -- 유효기간(년)
  carryover_allowed BOOLEAN DEFAULT false, -- 이월 가능 여부
  carryover_max_days INTEGER, -- 이월 최대 일수
  compensation_required BOOLEAN DEFAULT true, -- 미사용 보상금 필요 여부
  description TEXT,

  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP,
  created_by UUID,
  is_active BOOLEAN DEFAULT true
);

-- 초기 데이터
INSERT INTO hrm.leave_policies VALUES
('ANNUAL', 15, true, 2, false, NULL, true), -- 연차 15일
('SICK', 3, true, 1, false, NULL, false),   -- 병가 3일
('MATERNITY', 90, true, 1, false, NULL, false), -- 출산휴가 90일
('UNPAID', NULL, false, 1, false, NULL, false); -- 무급휴가
```

### 🎯 우선순위
- **P1 (즉시)**: absences, leave_policies 추가
- **담당**: HR팀 협의 필수
- **마감**: 2주 이내

---

## 03_CRM - 거래처관리

### 📊 현황
- **테이블 수**: 19개 (+ 1개 필요)
- **완성도**: ⭐⭐⭐⭐ (좋음)
- **상태**: 거래처 관리 기본은 완벽, 계약 관리 부족

### 📋 테이블 목록

| # | 테이블 | 목적 |
|---|--------|------|
| 1-5 | partners, partner_contacts, partner_addresses, partner_managers, partner_banks | 거래처 기본 |
| 6-12 | leads, opportunities, activities, interactions, campaigns, campaign_members, sales_targets | 영업 기회 |
| 13-18 | customer_segments, customer_segment_members, customer_surveys, email_templates, rfqs, rfq_items | 고객 관리 |

### ✅ 강점
- 통합된 거래처 마스터 (partners)
- 포괄적인 연락처/주소 관리
- 풍부한 영업 기회 추적
- 고객 세그먼트화

### 🔴 부족점

#### 1. 거래처 계약 관리 완전 부족
```
필요한 기능:
- 거래처와의 계약서 관리
- 계약 유형: 구매 계약, 공급 계약, 대리점 계약, 배타적 거래 계약
- 계약 갱신 추적
- 계약 조건 관리
- 계약서 첨부 문서

비즈니스 영향:
- 중소기업은 거래처와 계약을 통해 거래 조건 결정
- 계약 갱신 일정 관리 필수
- 거래 조건 일괄 관리 가능
```

### 📝 필수 추가 테이블

**파일1**: `03_crm/19_contracts.sql`
```sql
CREATE TABLE crm.contracts (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  partner_id UUID NOT NULL REFERENCES crm.partners(id) ON DELETE RESTRICT,

  -- 계약 기본 정보
  contract_code VARCHAR(50) NOT NULL UNIQUE,
  contract_type VARCHAR(30) NOT NULL,
    -- PURCHASE: 구매계약, SUPPLY: 공급계약,
    -- AGENCY: 대리점, EXCLUSIVE: 배타적 거래
  contract_title VARCHAR(200),

  -- 계약 기간
  contract_date DATE NOT NULL, -- 계약 체결일
  start_date DATE NOT NULL,
  end_date DATE, -- NULL이면 무기한
  renewal_date DATE, -- 갱신예정일
  auto_renewal BOOLEAN DEFAULT false,

  -- 계약 금액
  contract_amount NUMERIC(18,2),
  contract_currency VARCHAR(3) DEFAULT 'KRW',
  payment_terms VARCHAR(100), -- 결제조건

  -- 서명자
  signatory_company VARCHAR(200), -- 우리 회사 서명자
  signatory_partner VARCHAR(200), -- 거래처 서명자

  -- 계약서
  contract_file_path VARCHAR(500), -- 첨부 경로
  contract_notes TEXT,

  -- 상태
  status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE',
    -- ACTIVE: 활성, EXPIRED: 만료, TERMINATED: 해지, SUSPENDED: 중지

  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP,
  created_by UUID,
  updated_at TIMESTAMP WITH TIME ZONE,
  updated_by UUID,
  is_deleted BOOLEAN DEFAULT false
);

CREATE INDEX ix_contracts__partner_id ON crm.contracts(partner_id);
CREATE INDEX ix_contracts__contract_type ON crm.contracts(contract_type);
CREATE INDEX ix_contracts__renewal_date ON crm.contracts(renewal_date);
```

**파일2**: `03_crm/20_contract_items.sql` (선택사항)
```sql
CREATE TABLE crm.contract_items (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  contract_id UUID NOT NULL REFERENCES crm.contracts(id) ON DELETE CASCADE,

  item_seq INTEGER NOT NULL,
  item_category VARCHAR(100), -- 가격, 결제조건, 배송 등
  item_description VARCHAR(500),
  item_value VARCHAR(500),

  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP
);
```

### 🎯 우선순위
- **P2 (1개월 이내)**: contracts 테이블 추가
- **담당**: 영업팀 협의
- **마감**: 4주 이내

---

## 04_PIM - 상품관리

### 📊 현황
- **테이블 수**: 17개
- **완성도**: ⭐⭐⭐⭐⭐ (완벽)
- **상태**: 추가 개선 불필요

### 📋 테이블 목록

| # | 테이블 | 목적 |
|---|--------|------|
| 1-3 | makers, brands, categories | 상품 분류 |
| 4-16 | products, product_managers, product_images, product_suppliers, product_price_history, product_options, product_option_values, product_variants, product_units, product_unit_conversions, product_relations, product_tags | 상품 상세 |

### ✅ 강점
- 제조업체, 브랜드, 카테고리 완벽 분리
- SKU 및 상품 옵션 관리
- 단위 변환 관리
- 공급업체별 가격 추적
- 관련 상품 관리

### 📌 평가
**이 모듈은 중소기업 ERP 수준에서 최상급입니다. 추가 개선 불필요합니다.**

---

## 05_WMS - 창고관리

### 📊 현황
- **테이블 수**: 9개
- **완성도**: ⭐⭐⭐⭐ (좋음)
- **상태**: 기본 구조 완벽

### 📋 테이블 목록

| # | 테이블 | 목적 |
|---|--------|------|
| 1-3 | warehouses, warehouse_employees, warehouse_locations | 창고 관리 |
| 4-5 | receiving, receiving_items | 입고 |
| 6-7 | shipping, shipping_items | 출고 |
| 8 | inventory | 현재고 |

### ✅ 강점
- 창고 구조 명확 (창고 → 로케이션)
- 입/출고 문서 관리
- 현재고 관리

### 🟡 개선점 (선택사항)

```
1. 입/출고 이력 추적
   - 현재: shipping, receiving만 있음
   - 개선: 출고 후 배송 추적 (shipping_tracking)

2. 창고 이동 이력
   - 로케이션 간 이동 이력 추적
   - 이동 사유, 승인 워크플로우
```

### 🎯 우선순위
- **P3**: 개선 권장 (필수 아님)
- 기본 기능으로 충분

---

## 06_APM - 결재관리

### 📊 현황
- **테이블 수**: 5개
- **완성도**: ⭐⭐⭐⭐ (좋음)
- **상태**: 기본 구조 완벽

### 📋 테이블 목록

| # | 테이블 | 목적 |
|---|--------|------|
| 1 | approval_lines | 결재 라인 |
| 2 | approval_line_items | 라인 항목 |
| 3 | approval_requests | 결재 요청 |
| 4 | approval_histories | 결재 이력 |

### ✅ 강점
- 유연한 결재 라인 정의
- 결재 상태 추적

### 📌 평가
**기본 결재 워크플로우 충분합니다. 추가 개선 불필요합니다.**

---

## 10_IVM - 재고관리

### 📊 현황
- **테이블 수**: 11개
- **완성도**: ⭐⭐⭐⭐⭐ (완벽)
- **상태**: 매우 우수

### 📋 테이블 목록

| # | 테이블 | 목적 |
|---|--------|------|
| 1-2 | inventory_balances, inventory_movements | 기본 |
| 3-5 | inventory_transfers, inventory_adjustments, inventory_reservations | 조정 |
| 6-7 | inventory_lots, inventory_serial_numbers | 추적 |
| 8-10 | inventory_counts, inventory_count_items, inventory_cycle_counts | 실사 |

### ✅ 강점
- 현황 → 이동 → 잔액 일관성
- 로트/시리얼 추적
- 실사 프로세스
- 예약 재고 관리

### 📌 평가
**완벽한 재고 관리 시스템입니다. 추가 개선 불필요합니다.**

---

## 11_PSM - 구매관리

### 📊 현황
- **테이블 수**: 11개
- **완성도**: ⭐⭐⭐⭐ (완벽)
- **상태**: 매우 우수

### 📋 테이블 목록

| # | 테이블 | 목적 |
|---|--------|------|
| 1-2 | purchase_requisitions, purchase_requisition_items | 구매 요청 |
| 3-4 | purchase_orders, purchase_order_items | 구매 주문 |
| 5-6 | purchase_quotations, purchase_quotation_items | 공급업체 견적 |
| 7-8 | purchase_price_agreements, purchase_order_pr_links | 가격 계약 |
| 9-10 | purchase_order_receipts, purchase_order_receipt_items | 상품 수령 |

### ✅ 강점
- 완전한 구매 프로세스 (요청 → 주문 → 수령)
- 공급업체 견적 관리
- 가격 계약 추적

### 📌 평가
**완벽한 구매 관리 시스템입니다. 추가 개선 불필요합니다.**

---

## 12_SRM - 판매관리

### 📊 현황
- **테이블 수**: 11개 (+ 3개 필요)
- **완성도**: ⭐⭐⭐ (기본만 있음)
- **상태**: 프로모션, 반품정책 부족

### 📋 테이블 목록

| # | 테이블 | 목적 | 비고 |
|---|--------|------|------|
| 1-2 | quotations, quotation_items | 견적 | ✅ |
| 3-4 | sales_orders, sales_order_items | 주문 | ✅ |
| 5-6 | sales_deliveries, sales_delivery_items | 배송 | ✅ |
| 7-8 | sales_invoices, sales_invoice_items | 송장/세금계산서 | ⚠️ (FIM과 중복) |
| 9-10 | sales_returns, sales_return_items | 반품 | ⚠️ (정책 부족) |

### ✅ 강점
- 완전한 판매 프로세스 (견적 → 주문 → 배송 → 송장)

### 🔴 심각한 부족점

#### 1. 세금계산서 중복 관리 (P1)
```
문제:
- srm.sales_invoices (판매 관점)
- fim.tax_invoices (회계 관점)
- 데이터 정규화 위반

해결:
- fim.tax_invoices를 마스터로 통일
- srm에서는 VIEW로 제공
- srm.sales_invoices 제거
```

#### 2. 프로모션/할인 관리 없음 (P2)
```
필요한 기능:
- 계절 프로모션 관리
- 벌크 할인
- 고객별 할인
- 프로모션 효과 분석

현황: 없음
```

#### 3. 반품 정책 없음 (P2)
```
필요한 기능:
- 반품 가능 기간
- 반품 조건
- 환불액 계산
- 반품 승인 워크플로우

현황: 반품 기록만 있고 정책/승인 없음
```

### 📝 필수 추가 테이블

**파일1**: `12_srm/12_promotions.sql`
```sql
CREATE TABLE srm.promotions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

  -- 기본 정보
  promotion_code VARCHAR(50) NOT NULL UNIQUE,
  promotion_name VARCHAR(200) NOT NULL,
  promotion_type VARCHAR(30) NOT NULL,
    -- DISCOUNT_PERCENT: 할인율, DISCOUNT_AMOUNT: 할인액,
    -- BUY_X_GET_Y: X개 구매하면 Y개 특가, BUNDLE: 묶음

  -- 할인 조건
  discount_percent NUMERIC(5,2), -- 할인율 (%)
  discount_amount NUMERIC(18,2), -- 할인액
  min_order_amount NUMERIC(18,2), -- 최소 주문액
  max_discount_amount NUMERIC(18,2), -- 최대 할인액

  -- 대상
  customer_segment_id UUID REFERENCES crm.customer_segments(id),
  product_id UUID REFERENCES pim.products(id),

  -- 기간
  start_date DATE NOT NULL,
  end_date DATE,

  -- 기타
  priority INTEGER DEFAULT 0,
  is_active BOOLEAN DEFAULT true,
  description TEXT,

  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP,
  created_by UUID,
  updated_at TIMESTAMP WITH TIME ZONE,
  updated_by UUID,
  is_deleted BOOLEAN DEFAULT false
);
```

**파일2**: `12_srm/13_promotion_usage.sql`
```sql
CREATE TABLE srm.promotion_usage (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  promotion_id UUID NOT NULL REFERENCES srm.promotions(id),
  sales_order_id UUID NOT NULL REFERENCES srm.sales_orders(id),
  discount_applied NUMERIC(18,2) NOT NULL,
  applied_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP
);
```

### 🎯 우선순위
- **P1 (즉시)**: 세금계산서 통합 (srm.sales_invoices 제거)
- **P2 (1개월)**: promotions 테이블 추가
- **P2 (1개월)**: return_policies 테이블 추가

---

## 13_ASM - 서비스관리

### 📊 현황
- **테이블 수**: 7개 (+ 3개 필요)
- **완성도**: ⭐⭐⭐ (기본만 있음)
- **상태**: 피드백, 반품정책 부족

### 📋 테이블 목록

| # | 테이블 | 목적 | 비고 |
|---|--------|------|------|
| 1-2 | service_requests, service_works | 서비스 | ✅ |
| 3 | service_parts | 사용 부품 | ✅ |
| 4-5 | support_tickets, ticket_comments | 지원 | ✅ |
| 6 | faqs | FAQ | ✅ |
| 7 | customer_feedback | **고객 피드백** | 🔴 **필수 추가** |
| 8 | nps_surveys | **NPS 설문** | 🔴 **필수 추가** |
| 9 | return_policies | **반품 정책** | 🔴 **필수 추가** |

### ✅ 강점
- 서비스 워크플로우
- 지원 티켓 관리
- FAQ 관리

### 🔴 심각한 부족점

#### 1. 고객 피드백/평가 관리 완전 부족 (P1)
```
비즈니스 영향:
- CRM 고도화 필수
- 고객 만족도 추적 필요
- 제품/서비스 개선 정보 제공
- 거래처 신용도 평가

현황: 완전히 없음
```

#### 2. NPS(Net Promoter Score) 관리 부족
```
필요한 기능:
- 고객 추천도 조사
- 장점/단점 피드백
- 세그먼트별 분석
```

#### 3. 반품 정책 없음 (P2)
```
필요한 기능:
- 반품 가능 기간
- 반품 조건
- 환불액 계산
- 반품 승인 워크플로우
```

### 📝 필수 추가 테이블

**파일1**: `13_asm/07_customer_feedback.sql`
```sql
CREATE TABLE asm.customer_feedback (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

  -- 거래처 정보
  partner_id UUID NOT NULL REFERENCES crm.partners(id),

  -- 거래 정보
  transaction_type VARCHAR(20) NOT NULL,
    -- SALE: 판매, SERVICE: 서비스, SUPPORT: 지원
  transaction_id UUID, -- 해당 거래 ID (주문, 서비스, 티켓)

  -- 평가
  rating INTEGER NOT NULL CHECK (rating BETWEEN 1 AND 5), -- 1-5 별점
  comment TEXT,
  feedback_categories VARCHAR[], -- 배열: 품질, 배송, 고객서비스, 가격 등

  -- 회신
  response_text TEXT,
  response_by UUID REFERENCES hrm.employees(id),
  response_date TIMESTAMP WITH TIME ZONE,

  -- 상태
  status VARCHAR(20) NOT NULL DEFAULT 'NEW',
    -- NEW: 신규, REVIEWED: 검토, RESPONDED: 회신, CLOSED: 종결

  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP,
  created_by UUID,
  updated_at TIMESTAMP WITH TIME ZONE,
  updated_by UUID,
  is_deleted BOOLEAN DEFAULT false
);

CREATE INDEX ix_customer_feedback__partner_id ON asm.customer_feedback(partner_id);
CREATE INDEX ix_customer_feedback__rating ON asm.customer_feedback(rating);
CREATE INDEX ix_customer_feedback__status ON asm.customer_feedback(status);
```

**파일2**: `13_asm/08_nps_surveys.sql`
```sql
CREATE TABLE asm.nps_surveys (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

  partner_id UUID NOT NULL REFERENCES crm.partners(id),
  nps_score INTEGER NOT NULL CHECK (nps_score BETWEEN 0 AND 10),
  recommendation TEXT,

  sent_date DATE,
  response_date DATE,

  status VARCHAR(20) DEFAULT 'PENDING',
    -- PENDING: 대기, RESPONDED: 응답, CLOSED: 완료

  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP,
  created_by UUID
);
```

**파일3**: `13_asm/09_return_policies.sql`
```sql
CREATE TABLE asm.return_policies (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

  policy_code VARCHAR(50) NOT NULL UNIQUE,
  policy_name VARCHAR(200),

  -- 대상 상품
  product_category_id UUID REFERENCES pim.categories(id),

  -- 반품 조건
  return_period_days INTEGER NOT NULL, -- 반품 가능 기간(일)
  restocking_fee_percent NUMERIC(5,2), -- 재가공 수수료
  condition_required VARCHAR(100), -- 미개봉, 정상 상태 등

  -- 환불
  refund_method VARCHAR(20),
    -- ORIGINAL_PAYMENT: 원래 결제수단, STORE_CREDIT: 스토어 크레딧, EXCHANGE: 교환

  is_active BOOLEAN DEFAULT true,
  description TEXT,

  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP,
  created_by UUID
);
```

### 🎯 우선순위
- **P1 (즉시)**: customer_feedback, nps_surveys 추가
- **P2 (1개월)**: return_policies 추가

---

## 14_FIM - 재무관리

### 📊 현황
- **테이블 수**: 10개
- **완성도**: ⭐⭐⭐⭐⭐ (우수)
- **상태**: 세금계산서 통합 필요

### 📋 테이블 목록

| # | 테이블 | 목적 |
|---|--------|------|
| 1 | accounts | 계정과목 |
| 2-3 | journal_entries, journal_entry_lines | 일반일지 |
| 4-5 | accounts_receivable, accounts_payable | A/R, A/P |
| 6 | payment_transactions | 결제 거래 |
| 7 | business_documents | 업무 전표 |
| 8-9 | tax_invoices, tax_invoice_lines | 세금계산서 |

### ✅ 강점
- 완벽한 회계 구조
- 계정과목 관리
- 일반일지
- 미수/미지급 관리
- 세금계산서 (국세청 통합)

### 🟡 개선점

#### 1. 세금계산서 통합 (P1)
```
현황:
- fim.tax_invoices (회계 기록)
- srm.sales_invoices (판매 문서)
→ 중복

해결:
- fim.tax_invoices에 sales 필드 추가
- srm.sales_invoices 제거
```

#### 2. 자동 계정 매핑
```
권장사항:
- 판매 → 매출액 계정 자동 연결
- 구매 → 매입원가 계정 자동 연결
- 설정으로 관리 가능하게
```

### 🎯 우선순위
- **P1 (즉시)**: 세금계산서 통합 (srm.sales_invoices 제거)
- **P3**: 자동 계정 매핑 개선 (선택)

---

## 15_FAM - 자산관리

### 📊 현황
- **테이블 수**: 4개
- **완성도**: ⭐⭐⭐⭐ (우수)
- **상태**: 완벽함

### 📋 테이블 목록

| # | 테이블 | 목적 |
|---|--------|------|
| 1 | fixed_assets | 자산 |
| 2 | asset_depreciation | 감가상각 |
| 3 | asset_disposals | 처분 |

### ✅ 강점
- 기본 자산 관리 완벽
- 감가상각 추적
- 처분 관리

### 📌 평가
**충분한 수준입니다. 추가 개선 불필요합니다.**

---

## 20_BIM - 분석관리

### 📊 현황
- **테이블 수**: 5개
- **완성도**: ⭐⭐⭐ (기본)
- **상태**: KPI 확대 권장

### 📋 테이블 목록

| # | 테이블 | 목적 |
|---|--------|------|
| 1-2 | kpi_definitions, kpi_targets | KPI |
| 3-4 | sales_analytics, purchase_analytics | 분석 |

### 🟡 개선점 (P3)

```
현재: 기본 KPI와 판매/구매 분석만
권장: 확대할 분석

필요한 지표:
1. 거래처별 판매액 추이
2. 상품별 수익성 분석
3. 재고 회전율
4. 운영 효율성
5. 고객 획득 비용(CAC)
6. 고객 생애 가치(LTV)
```

### 🎯 우선순위
- **P3 (6개월)**: KPI 확대 (장기 계획)

---

## 21_COM - 공통설정

### 📊 현황
- **테이블 수**: 4개
- **완성도**: ⭐⭐⭐⭐ (좋음)
- **상태**: 기본 완벽

### 📋 테이블 목록

| # | 테이블 | 목적 |
|---|--------|------|
| 1-2 | code_groups, codes | 공통코드 |
| 3 | workflows | 워크플로우 |

### 🟡 개선점

```
추가 권장:
1. payment_terms (결제조건 마스터)
2. delivery_terms (배송조건 마스터)
```

### 🎯 우선순위
- **P3**: 마스터 데이터 추가

---

## 22_SYS - 시스템관리

### 📊 현황
- **테이블 수**: 6개
- **완성도**: ⭐⭐⭐⭐ (우수)
- **상태**: 완벽함

### 📋 테이블 목록

| # | 테이블 | 목적 |
|---|--------|------|
| 1-4 | users, roles, permissions, role_permissions | 권한 관리 |
| 5-6 | code_rules | 코드 규칙 |

### 📌 평가
**완벽한 권한 관리입니다. 추가 개선 불필요합니다.**

---

## 📊 종합 비교표

| 모듈 | 테이블 | 완성도 | P1 | P2 | P3 |
|------|--------|---------|----|----|-----|
| 01_ADM | 7 | ⭐⭐⭐⭐⭐ | | | 결제조건 |
| 02_HRM | 8+2 | ⭐⭐⭐⭐ | 휴가 추가 | | |
| 03_CRM | 19+1 | ⭐⭐⭐⭐ | | 계약 추가 | |
| 04_PIM | 17 | ⭐⭐⭐⭐⭐ | | | |
| 05_WMS | 9 | ⭐⭐⭐⭐ | | | 추적 강화 |
| 06_APM | 5 | ⭐⭐⭐⭐ | | | |
| 10_IVM | 11 | ⭐⭐⭐⭐⭐ | | | |
| 11_PSM | 11 | ⭐⭐⭐⭐ | | | |
| 12_SRM | 11+3 | ⭐⭐⭐ | 통합 필요 | 프로모션 | |
| 13_ASM | 7+3 | ⭐⭐⭐ | 피드백 추가 | 반품정책 | |
| 14_FIM | 10 | ⭐⭐⭐⭐⭐ | 통합 필요 | | |
| 15_FAM | 4 | ⭐⭐⭐⭐ | | | |
| 20_BIM | 5 | ⭐⭐⭐ | | | KPI 확대 |
| 21_COM | 4 | ⭐⭐⭐⭐ | | | 마스터 추가 |
| 22_SYS | 6 | ⭐⭐⭐⭐ | | | |

---

**작성일**: 2025-10-24
**버전**: 1.0
