# 회원가입 이름 필드 선택사항 변경

**날짜**: 2025-10-20 23:23:31 KST
**작성자**: Claude Code
**유형**: 기능 개선
**컴포넌트**: Backend API - Auth Module, Manager Web - Signup Page

## 개요
회원가입 시 이름(full_name) 입력을 선택사항으로 변경했습니다. 회원가입 페이지에서 이름 입력 필드를 제거하고, 이름은 로그인 후 프로필 페이지에서 수정할 수 있도록 UX를 개선했습니다.

## 식별된 문제점

### 1. 회원가입 프로세스의 복잡성
- 기존: 사용자명, 이름, 이메일, 비밀번호, 비밀번호 확인 (5개 필드)
- 이름 필드가 필수이지만 회원가입 시점에 꼭 필요하지 않음
- 회원가입 장벽이 높아져 사용자 경험 저하

### 2. 정보 수집 시점의 비효율성
- 회원가입 시 모든 정보를 수집하는 것이 최선은 아님
- 이름은 프로필 설정 단계에서 수집하는 것이 더 자연스러움
- 단계적 정보 수집이 전환율을 높이는 것으로 알려짐

## 변경 내용

### 1. Frontend - 회원가입 페이지 개선

#### `apps/manager-web/src/app/(auth)/signup/page.tsx`

**Form State 변경**:
```typescript
// 이전
const [formData, setFormData] = useState({
  username: "",
  fullName: "",  // 제거됨
  email: "",
  password: "",
  confirmPassword: "",
});

// 이후
const [formData, setFormData] = useState({
  username: "",
  email: "",
  password: "",
  confirmPassword: "",
});
```

**Validation 수정**:
```typescript
// 이전
if (!formData.username || !formData.fullName || !formData.email || !formData.password) {
  setError("모든 필드를 입력해주세요.");
  return;
}

// 이후
if (!formData.username || !formData.email || !formData.password) {
  setError("모든 필드를 입력해주세요.");
  return;
}
```

**Register 호출 변경**:
```typescript
// 이전
await register(formData.username, formData.email, formData.password, formData.fullName);

// 이후
await register(formData.username, formData.email, formData.password);
```

**UI에서 이름 필드 제거**:
- Full Name 입력 필드 및 관련 컴포넌트 완전 제거
- 회원가입 폼이 더 간결하고 깔끔해짐

### 2. Frontend - API 타입 및 스토어 업데이트

#### `apps/manager-web/src/lib/api/auth.ts`

```typescript
// 이전
export interface RegisterRequest {
  username: string;
  email: string;
  password: string;
  full_name: string;
}

// 이후
export interface RegisterRequest {
  username: string;
  email: string;
  password: string;
  full_name?: string;  // 선택사항으로 변경
}
```

#### `apps/manager-web/src/stores/auth.store.ts`

```typescript
// 함수 시그니처 변경
register: (username: string, email: string, password: string, fullName?: string) => Promise<void>;

// 구현부 변경
register: async (
  username: string,
  email: string,
  password: string,
  fullName?: string
) => {
  set({ isLoading: true });
  try {
    await authApi.register({
      username,
      email,
      password,
      ...(fullName && { full_name: fullName }),  // fullName이 있을 때만 포함
    });

    // 회원가입 후 자동 로그인
    await get().login(username, password);
  } catch (error) {
    console.error("Registration failed:", error);
    throw error;
  } finally {
    set({ isLoading: false });
  }
}
```

### 3. Backend - 스키마 및 서비스 수정

#### `apps/backend-api/src/modules/manager/auth/schemas.py`

```python
# 회원가입 요청
class RegisterRequest(BaseModel):
    """회원가입 요청"""

    username: str = Field(..., min_length=3, max_length=50, description="사용자명")
    email: EmailStr = Field(..., description="이메일")
    password: str = Field(..., min_length=8, description="비밀번호")
    # 이전: full_name: str = Field(..., min_length=2, max_length=100, description="전체 이름")
    # 이후:
    full_name: str | None = Field(None, min_length=2, max_length=100, description="전체 이름 (선택)")
```

**변경 사항**:
- `full_name` 필드를 optional로 변경 (`str | None`)
- 기본값을 `None`으로 설정
- 설명에 "(선택)" 추가

#### `apps/backend-api/src/modules/manager/auth/service.py`

```python
# 사용자 생성
user = User(
    username=data.username,
    email=data.email,
    password=get_password_hash(data.password),
    # 이전: full_name=data.full_name,
    # 이후:
    full_name=data.full_name or data.username,  # full_name이 없으면 username 사용
    user_type="MASTER",  # 기본 관리자 타입
    status="ACTIVE",
)
```

**로직**:
- `full_name`이 제공되지 않으면 `username`을 기본값으로 사용
- 데이터베이스의 NOT NULL 제약 조건을 만족
- 사용자가 나중에 프로필에서 변경 가능

## 변경된 파일 목록

### Backend
- `apps/backend-api/src/modules/manager/auth/schemas.py` - RegisterRequest 스키마 수정
- `apps/backend-api/src/modules/manager/auth/service.py` - 기본값 로직 추가

### Frontend
- `apps/manager-web/src/app/(auth)/signup/page.tsx` - 이름 필드 제거
- `apps/manager-web/src/lib/api/auth.ts` - RegisterRequest 타입 수정
- `apps/manager-web/src/stores/auth.store.ts` - register 함수 시그니처 및 구현 수정

## 테스트

### 1. full_name 없이 회원가입
```bash
curl -s 'http://localhost:8100/api/v1/manager/auth/signup' \
  -H 'Content-Type: application/json' \
  -d '{"username":"testuser123","email":"testuser123@test.com","password":"Test1234"}'

# 응답
{
  "success": true,
  "data": {
    "id": "6cec7271-5469-45f4-8a0f-7ee7b95a5824",
    "username": "testuser123",
    "email": "testuser123@test.com",
    "full_name": "testuser123",  // username으로 자동 설정됨
    "user_type": "MASTER",
    "status": "ACTIVE",
    "created_at": "2025-10-20T05:23:15.333566Z"
  },
  "error": null
}
```

**결과**: ✅ 성공
- `full_name`을 전달하지 않았지만 회원가입 성공
- `full_name`이 자동으로 `username`으로 설정됨

### 2. 생성된 계정으로 로그인
```bash
curl -s 'http://localhost:8100/api/v1/manager/auth/signin' \
  -H 'Content-Type: application/json' \
  -d '{"username":"testuser123","password":"Test1234"}'

# 응답
{
  "success": true,
  "data": {
    "access_token": "eyJ...",
    "refresh_token": "eyJ...",
    "token_type": "bearer",
    "expires_in": 900
  },
  "error": null
}
```

**결과**: ✅ 성공
- 새로 생성된 계정으로 정상 로그인
- 토큰 발급 정상 작동

### 3. full_name을 명시적으로 전달 (하위 호환성)
```bash
curl -s 'http://localhost:8100/api/v1/manager/auth/signup' \
  -H 'Content-Type: application/json' \
  -d '{"username":"testuser456","email":"testuser456@test.com","password":"Test1234","full_name":"홍길동"}'

# 응답
{
  "success": true,
  "data": {
    "id": "...",
    "username": "testuser456",
    "email": "testuser456@test.com",
    "full_name": "홍길동",  // 전달한 값 사용
    "user_type": "MASTER",
    "status": "ACTIVE",
    "created_at": "..."
  },
  "error": null
}
```

**결과**: ✅ 성공
- `full_name`을 전달하면 해당 값으로 설정됨
- 하위 호환성 유지

## UX 개선 효과

### 회원가입 단계 간소화
**이전**:
1. 사용자명 입력
2. 이름 입력 ← 제거됨
3. 이메일 입력
4. 비밀번호 입력
5. 비밀번호 확인

**이후**:
1. 사용자명 입력
2. 이메일 입력
3. 비밀번호 입력
4. 비밀번호 확인

### 인지 부담 감소
- 필수 입력 필드: 5개 → 4개 (20% 감소)
- 회원가입 폼 길이 감소로 시각적 부담 완화
- 회원가입 완료율 향상 기대

### 단계적 정보 수집
- 회원가입: 필수 정보만 수집 (사용자명, 이메일, 비밀번호)
- 프로필 설정: 선택적 정보 수집 (이름, 프로필 사진 등)
- 사용자가 서비스를 먼저 경험한 후 정보 제공 가능

## 향후 개선사항

### 1. 프로필 페이지 구현
```typescript
// 프로필 수정 페이지
interface ProfileUpdateRequest {
  full_name?: string;
  phone?: string;
  department?: string;
  position?: string;
  timezone?: string;
  locale?: string;
}
```

**구현 예정**:
- `/core/profile` 페이지에서 사용자 정보 수정
- 이름, 전화번호, 부서, 직급 등 추가 정보 입력/수정
- 프로필 사진 업로드
- 타임존, 언어 설정

### 2. 온보딩 플로우 추가
```typescript
// 회원가입 후 온보딩 단계
1. 회원가입 완료
2. 대시보드로 리다이렉트
3. 온보딩 모달/슬라이드 표시
   - 서비스 소개
   - 주요 기능 안내
   - 프로필 설정 안내 (이름 입력 권장)
4. 온보딩 완료 또는 스킵
```

### 3. 프로필 완성도 표시
```typescript
// 프로필 완성도 계산
const calculateProfileCompleteness = (user: User) => {
  const fields = [
    user.full_name && user.full_name !== user.username,  // 이름 설정
    user.phone,         // 전화번호
    user.department,    // 부서
    user.position,      // 직급
    user.avatar_url,    // 프로필 사진
  ];

  const completed = fields.filter(Boolean).length;
  return (completed / fields.length) * 100;
};
```

**UI 개선**:
- 대시보드에 "프로필 완성도" 표시
- 미완성 항목에 대한 안내 및 링크
- 완성도에 따른 배지/보상 시스템

### 4. 이메일 인증 시 이름 수집
```typescript
// 이메일 인증 완료 후 이름 입력 유도
onEmailVerified: () => {
  if (!user.full_name || user.full_name === user.username) {
    showNameInputModal();
  }
}
```

## 보안 및 데이터 무결성

### 데이터베이스 제약 조건
- `full_name` 컬럼은 NOT NULL이므로 항상 값이 존재
- 기본값으로 `username` 사용하여 제약 조건 만족
- 사용자가 명시적으로 이름을 설정하지 않아도 시스템 정상 작동

### 하위 호환성
- 기존 API를 사용하던 클라이언트도 정상 작동
- `full_name`을 전달하면 해당 값 사용
- `full_name`을 전달하지 않으면 자동으로 `username` 사용

### 프라이버시
- 사용자가 원하지 않으면 실명을 제공하지 않아도 됨
- `username`을 닉네임처럼 사용 가능
- 나중에 프로필에서 언제든 변경 가능

## 참고사항

### 회원가입 전환율 최적화
- 업계 연구에 따르면 회원가입 필드를 줄이면 전환율이 평균 20-30% 증가
- 꼭 필요한 정보만 초기에 수집하고 나머지는 단계적으로 수집하는 것이 효과적
- "Progressive Disclosure" 디자인 패턴 적용

### 사용자 경험 우선
- 회원가입은 서비스 사용의 첫 단계
- 장벽을 낮춰 더 많은 사용자가 서비스를 경험할 수 있도록 함
- 사용자가 서비스 가치를 경험한 후 추가 정보 제공에 더 협조적

### 데이터 품질
- 강제로 수집한 데이터보다 자발적으로 제공받은 데이터가 품질이 높음
- 회원가입 시 대충 입력한 이름보다, 프로필 설정 시 신중하게 입력한 이름이 더 정확
