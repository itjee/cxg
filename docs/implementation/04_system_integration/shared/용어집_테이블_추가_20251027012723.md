# 용어집 테이블 추가 (com.glossary)

**날짜**: 2025-10-27 01:27:23 KST
**작성자**: Claude (GitHub Copilot CLI)
**유형**: 기능 구현
**컴포넌트**: `packages/database/schemas/tenants/21_com`

## 개요

시스템에서 사용되는 비즈니스 용어를 체계적으로 관리하기 위한 용어집 테이블 `com.glossary`를 추가했습니다.

## 배경

ERP/CRM 시스템에서는 다양한 비즈니스 도메인(구매, 판매, 재무, 인사 등)의 전문 용어가 사용됩니다. 이러한 용어들을 표준화하고 일관되게 관리하기 위해 용어집 기능이 필요했습니다.

## 주요 기능

### 1. 기본 용어 정보
- **용어 코드**: 시스템 내부 식별자
- **용어명**: 한글/영문 용어명
- **약어**: 축약형 표기
- **정의**: 용어의 명확한 정의
- **설명**: 상세 설명 및 사용 예시

### 2. 분류 및 카테고리
- **카테고리**: 재무, 구매, 판매, 인사 등
- **도메인**: PSM, SRM, FIM, HRM 등 모듈별 분류
- **태그**: 유연한 검색을 위한 태그 배열

### 3. 용어 간 관계
- **상위 용어**: 계층 구조 지원 (parent_term_id)
- **관련 용어**: 연관된 용어들의 ID 배열
- **동의어/반의어**: 용어 간 의미 관계 정의

### 4. 참조 및 문서화
- **참조 URL**: 외부 정의 링크
- **참조 문서**: 관련 문서 정보
- **사용 예시**: 실제 사용 예시 텍스트

### 5. 사용 통계
- **사용 빈도**: 조회 횟수 추적
- **마지막 사용**: 최근 참조 시간

## 테이블 구조

```sql
CREATE TABLE com.glossary
(
    -- 기본 식별자
    id                      UUID PRIMARY KEY,
    created_at              TIMESTAMP WITH TIME ZONE,
    created_by              UUID,
    updated_at              TIMESTAMP WITH TIME ZONE,
    updated_by              UUID,
    
    -- 용어 정보
    term_code               VARCHAR(50) NOT NULL,        -- 용어 코드
    term_name               VARCHAR(200) NOT NULL,       -- 용어명 (한글)
    term_name_en            VARCHAR(200),                -- 용어명 (영문)
    abbreviation            VARCHAR(50),                 -- 약어
    
    -- 설명
    definition              TEXT NOT NULL,               -- 용어 정의
    description             TEXT,                        -- 상세 설명
    example                 TEXT,                        -- 사용 예시
    
    -- 분류
    category                VARCHAR(50),                 -- 카테고리
    domain                  VARCHAR(50),                 -- 도메인
    tags                    TEXT[],                      -- 태그 배열
    
    -- 관계
    parent_term_id          UUID,                        -- 상위 용어
    related_terms           UUID[],                      -- 관련 용어 배열
    synonyms                TEXT[],                      -- 동의어 배열
    antonyms                TEXT[],                      -- 반의어 배열
    
    -- 참조
    reference_url           TEXT,                        -- 참조 URL
    reference_document      TEXT,                        -- 참조 문서
    
    -- 사용 정보
    usage_count             INTEGER DEFAULT 0,           -- 사용 빈도
    last_used_at            TIMESTAMP WITH TIME ZONE,    -- 마지막 사용
    
    -- 속성
    display_order           INTEGER DEFAULT 0,           -- 표시 순서
    is_important            BOOLEAN DEFAULT false,       -- 중요 용어 여부
    is_system_term          BOOLEAN DEFAULT false,       -- 시스템 기본 용어
    
    -- 상태
    is_active               BOOLEAN DEFAULT true,
    is_deleted              BOOLEAN DEFAULT false,
    
    CONSTRAINT fk_glossary__parent_term_id
        FOREIGN KEY (parent_term_id)
        REFERENCES com.glossary(id)
        ON DELETE SET NULL
);
```

## 인덱스 전략

### 1. 기본 조회 인덱스
```sql
-- 용어명 조회
ix_glossary__term_name
ix_glossary__term_name_en

-- 분류별 조회
ix_glossary__category
ix_glossary__domain
```

### 2. 검색 최적화
```sql
-- 태그 검색 (GIN 인덱스)
ix_glossary__tags

-- 전체 텍스트 검색 (GIN 인덱스)
ix_glossary__search  -- term_name, term_name_en, abbreviation, definition, description
```

### 3. 관계 조회
```sql
-- 계층 구조 조회
ix_glossary__parent_term_id

-- 중요도 및 정렬
ix_glossary__is_important

-- 사용 빈도
ix_glossary__usage_count
```

### 4. 유니크 제약
```sql
-- 용어 코드 유니크
ux_glossary__term_code

-- 카테고리별 용어명 유니크
ux_glossary__term_name (term_name, category)
```

## 사용 예시

### 1. 용어 등록
```sql
INSERT INTO com.glossary (
    term_code,
    term_name,
    term_name_en,
    abbreviation,
    definition,
    category,
    domain,
    tags
) VALUES (
    'PO',
    '구매 주문',
    'Purchase Order',
    'PO',
    '공급업체에게 상품이나 서비스를 주문하는 공식 문서',
    '구매',
    'PSM',
    ARRAY['구매', '주문', '발주']
);
```

### 2. 계층 구조 (상위-하위 용어)
```sql
-- 상위 용어: 재고
INSERT INTO com.glossary (term_code, term_name, definition)
VALUES ('INVENTORY', '재고', '보유하고 있는 상품의 총량');

-- 하위 용어: 안전 재고
INSERT INTO com.glossary (
    term_code, 
    term_name, 
    definition,
    parent_term_id
)
VALUES (
    'SAFETY_STOCK',
    '안전 재고',
    '수요 변동에 대비한 최소 재고량',
    (SELECT id FROM com.glossary WHERE term_code = 'INVENTORY')
);
```

### 3. 관련 용어 설정
```sql
UPDATE com.glossary
SET related_terms = ARRAY[
    (SELECT id FROM com.glossary WHERE term_code = 'SO'),
    (SELECT id FROM com.glossary WHERE term_code = 'INVOICE')
]
WHERE term_code = 'PO';
```

### 4. 동의어 설정
```sql
UPDATE com.glossary
SET synonyms = ARRAY['발주서', '구매서', '주문서']
WHERE term_code = 'PO';
```

### 5. 전체 텍스트 검색
```sql
-- "구매" 관련 모든 용어 검색
SELECT 
    term_code,
    term_name,
    term_name_en,
    definition,
    category
FROM com.glossary
WHERE to_tsvector('simple',
        COALESCE(term_name, '') || ' ' ||
        COALESCE(term_name_en, '') || ' ' ||
        COALESCE(definition, '')
    ) @@ to_tsquery('simple', '구매')
  AND is_deleted = false
ORDER BY usage_count DESC;
```

### 6. 카테고리별 중요 용어 조회
```sql
SELECT 
    term_code,
    term_name,
    definition,
    usage_count
FROM com.glossary
WHERE category = '재무'
  AND is_important = true
  AND is_deleted = false
ORDER BY display_order, usage_count DESC;
```

### 7. 계층 구조 조회 (재귀 CTE)
```sql
WITH RECURSIVE term_hierarchy AS (
    -- 최상위 용어
    SELECT 
        id,
        term_code,
        term_name,
        parent_term_id,
        0 AS level,
        ARRAY[id] AS path
    FROM com.glossary
    WHERE parent_term_id IS NULL
      AND is_deleted = false
    
    UNION ALL
    
    -- 하위 용어
    SELECT 
        g.id,
        g.term_code,
        g.term_name,
        g.parent_term_id,
        th.level + 1,
        th.path || g.id
    FROM com.glossary g
    INNER JOIN term_hierarchy th ON g.parent_term_id = th.id
    WHERE g.is_deleted = false
)
SELECT 
    REPEAT('  ', level) || term_name AS term_tree,
    term_code,
    level
FROM term_hierarchy
ORDER BY path;
```

## 활용 시나리오

### 1. 신입 사원 온보딩
- 업무에 필요한 전문 용어 학습
- 카테고리별 용어집 제공
- 검색을 통한 즉시 참조

### 2. 시스템 문서화
- API 문서에서 용어 자동 링크
- 사용자 매뉴얼에 용어 설명 자동 삽입
- 일관된 용어 사용 강제

### 3. 다국어 지원
- 한글/영문 용어명 제공
- 글로벌 사용자를 위한 표준 용어 정의

### 4. 데이터 품질 관리
- 입력 폼에서 용어 자동완성
- 표준 용어 사용 유도
- 데이터 일관성 향상

### 5. 교육 및 참조
- 사내 위키/지식베이스 통합
- 챗봇/AI 어시스턴트 학습 데이터
- 온라인 교육 콘텐츠 생성

## 변경된 파일 목록

### 추가된 파일
- `packages/database/schemas/tenants/21_com/03_glossary.sql`

### 수정된 파일
- `packages/database/schemas/tenants/21_com/00_schema.sql`

## 향후 개선사항

1. **버전 관리**
   - 용어 정의 변경 이력 추적
   - 이전 버전 참조 기능

2. **다국어 확장**
   - 중국어, 일본어 등 추가 언어 지원
   - 언어별 정의 테이블 분리

3. **AI 통합**
   - LLM을 활용한 용어 자동 제안
   - 문맥 기반 용어 설명 생성

4. **워크플로우 통합**
   - 용어 승인 프로세스
   - 용어 변경 요청 관리

5. **분석 기능**
   - 용어 사용 통계 대시보드
   - 미사용 용어 정리 제안
   - 중복/유사 용어 감지

## 참고사항

- 용어 코드는 영문 대문자, 숫자, 언더스코어만 허용 (2-50자)
- 시스템 기본 용어(`is_system_term = true`)는 삭제 불가
- 전체 텍스트 검색은 PostgreSQL의 `tsvector`와 `tsquery` 사용
- 태그 검색은 GIN 인덱스를 활용하여 성능 최적화
