# CRUD ëª¨ë“ˆ ìƒì„± ì™„ë£Œ ë³´ê³ ì„œ

## ğŸ“Š ìƒì„± ê°œìš”

Manager ì‹œìŠ¤í…œì˜ ëª¨ë“  ìŠ¤í‚¤ë§ˆì— ëŒ€í•œ CRUD ëª¨ë“ˆì„ ì„±ê³µì ìœ¼ë¡œ ìƒì„±í–ˆìŠµë‹ˆë‹¤.

- **ìƒì„± ì¼ì‹œ**: 2025-10-15
- **ì´ ìŠ¤í‚¤ë§ˆ**: 13ê°œ
- **ì´ ëª¨ë“ˆ**: 43ê°œ
- **ì´ íŒŒì¼**: 187ê°œ

## ğŸ“‚ ìƒì„±ëœ ëª¨ë“ˆ

### 1. ì¸ì¦ (auth)
- âœ… ë¡œê·¸ì¸, íšŒì›ê°€ì…, í† í° ê°±ì‹  ë“± ê¸°ë³¸ ì¸ì¦ ê¸°ëŠ¥

### 2. IDAM (Identity & Access Management)
- âœ… users - ì‚¬ìš©ì ê´€ë¦¬
- âœ… roles - ì—­í•  ê´€ë¦¬
- âœ… permissions - ê¶Œí•œ ê´€ë¦¬
- âœ… role_permissions - ì—­í• -ê¶Œí•œ ë§¤í•‘
- âœ… user_roles - ì‚¬ìš©ì-ì—­í•  ë§¤í•‘
- âœ… sessions - ì„¸ì…˜ ê´€ë¦¬
- âœ… api_keys - API í‚¤ ê´€ë¦¬
- âœ… login_logs - ë¡œê·¸ì¸ ë¡œê·¸

### 3. í…Œë„ŒíŠ¸ ê´€ë¦¬ (tnnt)
- âœ… tenants - í…Œë„ŒíŠ¸ ê´€ë¦¬
- âœ… subscriptions - êµ¬ë… ê´€ë¦¬

### 4. ë¹Œë§ (bill)
- âœ… plans - ìš”ê¸ˆì œ ê´€ë¦¬
- âœ… invoices - ì²­êµ¬ì„œ ê´€ë¦¬
- âœ… transactions - ê±°ë˜ ë‚´ì—­

### 5. ê°ì‚¬ (audt)
- âœ… audit_logs - ê°ì‚¬ ë¡œê·¸
- âœ… policies - ì •ì±… ê´€ë¦¬
- âœ… compliances - ì»´í”Œë¼ì´ì–¸ìŠ¤

### 6. ìë™í™” (auto)
- âœ… workflows - ì›Œí¬í”Œë¡œìš°
- âœ… tasks - ì‘ì—… ê´€ë¦¬
- âœ… executions - ì‹¤í–‰ ì´ë ¥

### 7. ë°±ì—… (bkup)
- âœ… schedules - ë°±ì—… ìŠ¤ì¼€ì¤„
- âœ… executions - ë°±ì—… ì‹¤í–‰ ì´ë ¥
- âœ… recovery_plans - ë³µêµ¬ ê³„íš

### 8. ì„¤ì • (cnfg)
- âœ… configurations - ì‹œìŠ¤í…œ ì„¤ì •
- âœ… feature_flags - ê¸°ëŠ¥ í”Œë˜ê·¸
- âœ… tenant_features - í…Œë„ŒíŠ¸ ê¸°ëŠ¥
- âœ… service_quotas - ì„œë¹„ìŠ¤ í• ë‹¹ëŸ‰

### 9. ì¸í”„ë¼ (ifra)
- âœ… resources - ë¦¬ì†ŒìŠ¤ ê´€ë¦¬
- âœ… resource_usages - ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰

### 10. í†µí•© (intg)
- âœ… apis - API í†µí•©
- âœ… webhooks - ì›¹í›…
- âœ… rate_limits - ì†ë„ ì œí•œ

### 11. ëª¨ë‹ˆí„°ë§ (mntr)
- âœ… system_metrics - ì‹œìŠ¤í…œ ë©”íŠ¸ë¦­
- âœ… health_checks - í—¬ìŠ¤ ì²´í¬
- âœ… incidents - ì¥ì•  ê´€ë¦¬

### 12. ì•Œë¦¼ (noti)
- âœ… templates - ì•Œë¦¼ í…œí”Œë¦¿
- âœ… notifications - ì•Œë¦¼ ê´€ë¦¬
- âœ… campaigns - ìº í˜ì¸

### 13. í†µê³„ (stat)
- âœ… usage_stats - ì‚¬ìš©ëŸ‰ í†µê³„
- âœ… tenant_stats - í…Œë„ŒíŠ¸ í†µê³„

### 14. ì§€ì› (supt)
- âœ… tickets - í‹°ì¼“ ê´€ë¦¬
- âœ… ticket_comments - í‹°ì¼“ ëŒ“ê¸€
- âœ… feedbacks - í”¼ë“œë°±

## ğŸ—ï¸ ëª¨ë“ˆ êµ¬ì¡°

ê° ëª¨ë“ˆì€ ë‹¤ìŒ 4ê°œ íŒŒì¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:

```
module_name/
â”œâ”€â”€ __init__.py      # ëª¨ë“ˆ ì´ˆê¸°í™” ë° exports
â”œâ”€â”€ schemas.py       # Pydantic ìŠ¤í‚¤ë§ˆ ì •ì˜
â”‚   â”œâ”€â”€ Base         # ê¸°ë³¸ í•„ë“œ
â”‚   â”œâ”€â”€ Create       # ìƒì„± ì‹œ í•„ìš”í•œ í•„ë“œ
â”‚   â”œâ”€â”€ Update       # ìˆ˜ì • ì‹œ ì„ íƒì  í•„ë“œ
â”‚   â”œâ”€â”€ Response     # ì‘ë‹µ ìŠ¤í‚¤ë§ˆ
â”‚   â””â”€â”€ ListResponse # ëª©ë¡ ì‘ë‹µ (í˜ì´ì§€ë„¤ì´ì…˜)
â”œâ”€â”€ service.py       # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”œâ”€â”€ create()     # ë°ì´í„° ìƒì„±
â”‚   â”œâ”€â”€ get_by_id()  # IDë¡œ ì¡°íšŒ
â”‚   â”œâ”€â”€ get_list()   # ëª©ë¡ ì¡°íšŒ (í˜ì´ì§€ë„¤ì´ì…˜)
â”‚   â”œâ”€â”€ update()     # ë°ì´í„° ìˆ˜ì •
â”‚   â””â”€â”€ delete()     # ì†Œí”„íŠ¸ ì‚­ì œ
â””â”€â”€ router.py        # API ì—”ë“œí¬ì¸íŠ¸
    â”œâ”€â”€ POST /       # ìƒì„±
    â”œâ”€â”€ GET /        # ëª©ë¡ ì¡°íšŒ
    â”œâ”€â”€ GET /{id}    # ìƒì„¸ ì¡°íšŒ
    â”œâ”€â”€ PUT /{id}    # ìˆ˜ì •
    â””â”€â”€ DELETE /{id} # ì‚­ì œ
```

## ğŸ”— API ì—”ë“œí¬ì¸íŠ¸

### ê¸°ë³¸ URL
```
/api/v1/manager
```

### ì¸ì¦ API
```
POST   /auth/register              # íšŒì›ê°€ì…
POST   /auth/login                 # ë¡œê·¸ì¸
POST   /auth/refresh               # í† í° ê°±ì‹ 
GET    /auth/me                    # í˜„ì¬ ì‚¬ìš©ì ì •ë³´
POST   /auth/change-password       # ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
POST   /auth/logout                # ë¡œê·¸ì•„ì›ƒ
```

### CRUD íŒ¨í„´ (ëª¨ë“  ëª¨ë“ˆ ê³µí†µ)
```
POST   /{schema}/{module}          # ìƒì„±
GET    /{schema}/{module}          # ëª©ë¡ ì¡°íšŒ
GET    /{schema}/{module}/{id}     # ìƒì„¸ ì¡°íšŒ
PUT    /{schema}/{module}/{id}     # ìˆ˜ì •
DELETE /{schema}/{module}/{id}     # ì‚­ì œ
```

ì˜ˆì‹œ:
- `POST /idam/users` - ì‚¬ìš©ì ìƒì„±
- `GET /idam/users?page=1&page_size=20` - ì‚¬ìš©ì ëª©ë¡
- `GET /idam/users/{user_id}` - ì‚¬ìš©ì ìƒì„¸
- `PUT /idam/users/{user_id}` - ì‚¬ìš©ì ìˆ˜ì •
- `DELETE /idam/users/{user_id}` - ì‚¬ìš©ì ì‚­ì œ

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

### 1. í‘œì¤€ CRUD ì‘ì—…
- âœ… Create: POST ìš”ì²­ìœ¼ë¡œ ìƒˆ ë°ì´í„° ìƒì„±
- âœ… Read: GET ìš”ì²­ìœ¼ë¡œ ëª©ë¡ ë° ìƒì„¸ ì¡°íšŒ
- âœ… Update: PUT ìš”ì²­ìœ¼ë¡œ ë°ì´í„° ìˆ˜ì •
- âœ… Delete: DELETE ìš”ì²­ìœ¼ë¡œ ì†Œí”„íŠ¸ ì‚­ì œ

### 2. í˜ì´ì§€ë„¤ì´ì…˜
- `page`: í˜ì´ì§€ ë²ˆí˜¸ (ê¸°ë³¸ê°’: 1)
- `page_size`: í˜ì´ì§€ í¬ê¸° (ê¸°ë³¸ê°’: 20, ìµœëŒ€: 100)
- ì‘ë‹µ: `total`, `page`, `page_size`, `total_pages` í¬í•¨

### 3. ê²€ìƒ‰ ë° í•„í„°
- `search`: í‚¤ì›Œë“œ ê²€ìƒ‰
- ê° ëª¨ë“ˆë³„ íŠ¹í™” í•„í„° (status, user_type ë“±)

### 4. ì¸ì¦ ë° ê¶Œí•œ
- JWT í† í° ê¸°ë°˜ ì¸ì¦
- ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ ì¸ì¦ í•„ìš” (auth ì œì™¸)
- `created_by`, `updated_by` ìë™ ê¸°ë¡

### 5. í‘œì¤€ ì‘ë‹µ í˜•ì‹
```json
{
  "success": true,
  "data": { ... },
  "message": "Success",
  "timestamp": "2025-10-15T09:00:00Z"
}
```

### 6. ì—ëŸ¬ í•¸ë“¤ë§
- **404**: ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ
- **400**: ì˜ëª»ëœ ìš”ì²­
- **422**: ê²€ì¦ ì‹¤íŒ¨
- **500**: ì„œë²„ ì˜¤ë¥˜

### 7. ì†Œí”„íŠ¸ ì‚­ì œ
- `is_active` í•„ë“œë¡œ ê´€ë¦¬
- ì‚­ì œ ì‹œ ë°ì´í„° ë³´ì¡´
- ì¡°íšŒ ì‹œ ìë™ í•„í„°ë§ (`is_active = True`)

## ğŸ§ª í…ŒìŠ¤íŠ¸ ë°©ë²•

### 1. ì„œë²„ ì‹¤í–‰
```bash
cd apps/backend-api
uvicorn src.main:app --reload --port 8000
```

### 2. API ë¬¸ì„œ í™•ì¸
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

### 3. íšŒì›ê°€ì…
```bash
curl -X POST http://localhost:8000/api/v1/manager/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "test",
    "password": "Test1234!",
    "email": "test@example.com",
    "full_name": "í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì",
    "user_type": "MASTER"
  }'
```

### 4. ë¡œê·¸ì¸
```bash
curl -X POST http://localhost:8000/api/v1/manager/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "test",
    "password": "Test1234!"
  }'
```

### 5. API í˜¸ì¶œ
```bash
curl -X GET http://localhost:8000/api/v1/manager/idam/users \
  -H "Authorization: Bearer {access_token}"
```

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„

### 1. ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬
```bash
cd apps/backend-api
uv pip install ruff mypy
make format      # ì½”ë“œ í¬ë§·íŒ…
make lint        # ë¦°íŠ¸ ê²€ì‚¬
make typecheck   # íƒ€ì… ê²€ì‚¬
```

### 2. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
```bash
alembic revision --autogenerate -m "Add all manager models"
alembic upgrade head
```

### 3. í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±
```bash
pytest tests/
```

### 4. Tenants ì‹œìŠ¤í…œ êµ¬í˜„
- `packages/database/schemas/tenants/` ìŠ¤í‚¤ë§ˆ ë¶„ì„
- `src/models/tenants/` ëª¨ë¸ ìƒì„±
- `src/modules/tenants/` CRUD ëª¨ë“ˆ ìƒì„±

### 5. API ë¬¸ì„œ ë³´ê°•
- ê° ì—”ë“œí¬ì¸íŠ¸ ìƒì„¸ ì„¤ëª… ì¶”ê°€
- ìš”ì²­/ì‘ë‹µ ì˜ˆì œ ì¶”ê°€
- ì—ëŸ¬ ì¼€ì´ìŠ¤ ë¬¸ì„œí™”

## ğŸ¯ ê°œì„  ì‚¬í•­

### ì™„ë£Œëœ ì‘ì—…
- âœ… 13ê°œ ìŠ¤í‚¤ë§ˆì˜ ëª¨ë“  ëª¨ë“ˆ ìë™ ìƒì„±
- âœ… í‘œì¤€ CRUD íŒ¨í„´ êµ¬í˜„
- âœ… í˜ì´ì§€ë„¤ì´ì…˜ ë° ê²€ìƒ‰ ê¸°ëŠ¥
- âœ… ì¸ì¦ ë° ê¶Œí•œ ì²´í¬
- âœ… ì—ëŸ¬ í•¸ë“¤ë§
- âœ… API ë¼ìš°í„° ìë™ ë“±ë¡
- âœ… ì†Œí”„íŠ¸ ì‚­ì œ êµ¬í˜„

### í–¥í›„ ê°œì„  ì‚¬í•­
- â­ï¸ ê° ëª¨ë“ˆë³„ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì„¸ë¶€ êµ¬í˜„
- â­ï¸ ê²€ìƒ‰ í•„í„° ê³ ë„í™” (ì „ì²´ í…ìŠ¤íŠ¸ ê²€ìƒ‰)
- â­ï¸ ì •ë ¬ ê¸°ëŠ¥ ì¶”ê°€
- â­ï¸ ë²Œí¬ ì‘ì—… API (ì¼ê´„ ì‚­ì œ ë“±)
- â­ï¸ Export/Import ê¸°ëŠ¥
- â­ï¸ ê°ì‚¬ ë¡œê·¸ ìë™ ê¸°ë¡
- â­ï¸ ìºì‹± êµ¬í˜„ (Redis)
- â­ï¸ Rate limiting

## ğŸ“Š íŒŒì¼ í†µê³„

```
ì´ íŒŒì¼ ìˆ˜: 187ê°œ

ìŠ¤í‚¤ë§ˆë³„:
- auth: 5ê°œ íŒŒì¼
- idam: 33ê°œ íŒŒì¼ (8ê°œ ëª¨ë“ˆ)
- tnnt: 9ê°œ íŒŒì¼ (2ê°œ ëª¨ë“ˆ)
- bill: 13ê°œ íŒŒì¼ (3ê°œ ëª¨ë“ˆ)
- audt: 13ê°œ íŒŒì¼ (3ê°œ ëª¨ë“ˆ)
- auto: 13ê°œ íŒŒì¼ (3ê°œ ëª¨ë“ˆ)
- bkup: 13ê°œ íŒŒì¼ (3ê°œ ëª¨ë“ˆ)
- cnfg: 17ê°œ íŒŒì¼ (4ê°œ ëª¨ë“ˆ)
- ifra: 9ê°œ íŒŒì¼ (2ê°œ ëª¨ë“ˆ)
- intg: 13ê°œ íŒŒì¼ (3ê°œ ëª¨ë“ˆ)
- mntr: 13ê°œ íŒŒì¼ (3ê°œ ëª¨ë“ˆ)
- noti: 13ê°œ íŒŒì¼ (3ê°œ ëª¨ë“ˆ)
- stat: 9ê°œ íŒŒì¼ (2ê°œ ëª¨ë“ˆ)
- supt: 13ê°œ íŒŒì¼ (3ê°œ ëª¨ë“ˆ)
```

## ğŸ‰ ê²°ë¡ 

Manager ì‹œìŠ¤í…œì˜ ì „ì²´ ë°±ì—”ë“œ API ê¸°ë°˜ì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤!

- **13ê°œ ë„ë©”ì¸**ì˜ **43ê°œ ëª¨ë“ˆ**
- **187ê°œ íŒŒì¼**ì˜ ì²´ê³„ì ì¸ êµ¬ì¡°
- **í‘œì¤€ CRUD íŒ¨í„´** ì¼ê´€ì„± ìœ ì§€
- **ì¸ì¦/ê¶Œí•œ**, **í˜ì´ì§€ë„¤ì´ì…˜**, **ê²€ìƒ‰** ê¸°ëŠ¥ ë‚´ì¥
- **í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜**

ì´ì œ ì„œë²„ë¥¼ ì‹¤í–‰í•˜ê³  Swagger UIì—ì„œ ëª¨ë“  APIë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸš€

## ğŸ”§ ìë™ ìƒì„± ë„êµ¬

í–¥í›„ ì¬ì‚¬ìš©ì„ ìœ„í•´ `generate_crud_modules.py` ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë³´ì¡´í–ˆìŠµë‹ˆë‹¤:

```bash
python generate_crud_modules.py
```

ì´ ìŠ¤í¬ë¦½íŠ¸ë¡œ ìƒˆë¡œìš´ ëª¨ë¸ì´ ì¶”ê°€ë  ë•Œë§ˆë‹¤ CRUD ëª¨ë“ˆì„ ìë™ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

**ìƒì„± ì™„ë£Œ ì¼ì‹œ**: 2025-10-15  
**ìƒì„± ë„êµ¬**: generate_crud_modules.py  
**ì•„í‚¤í…ì²˜**: FastAPI + SQLAlchemy + Pydantic
