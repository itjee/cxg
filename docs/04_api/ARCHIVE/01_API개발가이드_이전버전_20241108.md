# CXG í”Œë«í¼ - API ê°œë°œ ì™„ì „ ê°€ì´ë“œ

> **FastAPI ê¸°ë°˜ ë°±ì—”ë“œ ê°œë°œ ë° ì—”ë“œí¬ì¸íŠ¸ êµ¬í˜„ ì™„ì „ ê°€ì´ë“œ**
> - **ëŒ€ìƒ ë…ì**: ë°±ì—”ë“œ ê°œë°œì, API ì•„í‚¤í…íŠ¸
> - **ì½ëŠ” ì‹œê°„**: 1.5-2ì‹œê°„
> - **ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2024ë…„ 11ì›” 8ì¼

---

## ëª©ì°¨

1. [ë¹ ë¥¸ ì‹œì‘](#ë¹ ë¥¸-ì‹œì‘)
2. [í”„ë¡œì íŠ¸ êµ¬ì¡° ë¶„ì„](#í”„ë¡œì íŠ¸-êµ¬ì¡°-ë¶„ì„)
3. [í•µì‹¬ ê°œë…](#í•µì‹¬-ê°œë…)
4. [Models ê³„ì¸µ](#models-ê³„ì¸µ)
5. [Modules ê³„ì¸µ](#modules-ê³„ì¸µ)
6. [Routers ê³„ì¸µ](#routers-ê³„ì¸µ)
7. [Core ê³„ì¸µ](#core-ê³„ì¸µ)
8. [ì—”ë“œí¬ì¸íŠ¸ ê°œë°œ ì‹¤ìŠµ](#ì—”ë“œí¬ì¸íŠ¸-ê°œë°œ-ì‹¤ìŠµ)
9. [ì¸ì¦ ë° ê¶Œí•œ](#ì¸ì¦-ë°-ê¶Œí•œ)
10. [ì—ëŸ¬ ì²˜ë¦¬](#ì—ëŸ¬-ì²˜ë¦¬)
11. [í…ŒìŠ¤íŠ¸ ë° ë°°í¬](#í…ŒìŠ¤íŠ¸-ë°-ë°°í¬)

---

## ë¹ ë¥¸ ì‹œì‘

### ê°œë°œ í™˜ê²½ ì„¤ì •

```bash
cd apps/backend-api

# 1. ê°€ìƒ í™˜ê²½ ìƒì„±
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate  # Windows

# 2. ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt

# 3. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
alembic upgrade head

# 4. ê°œë°œ ì„œë²„ ì‹œì‘
uvicorn src.main:app --reload --host 0.0.0.0 --port 8100
```

### API ë¬¸ì„œ ì ‘ê·¼

```
- Swagger UI: http://localhost:8100/docs
- ReDoc: http://localhost:8100/redoc
- Scalar: http://localhost:8100/scalar
```

### ë¹ ë¥¸ í…ŒìŠ¤íŠ¸

```bash
# í—¬ìŠ¤ ì²´í¬
curl http://localhost:8100/health

# ì‚¬ìš©ì ìƒì„± (ì˜ˆì œ)
curl -X POST http://localhost:8100/api/v1/manager/idam/users \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "full_name": "Test User",
    "email": "test@example.com",
    "password": "Password123!",
    "user_type": "TENANT"
  }'
```

---

## í”„ë¡œì íŠ¸ êµ¬ì¡° ë¶„ì„

### ì „ì²´ ì•„í‚¤í…ì²˜

```
apps/backend-api/src/
â”œâ”€â”€ core/                    # í”„ë ˆì„ì›Œí¬ ì„¤ì • ë° ê³µí†µ ê¸°ëŠ¥
â”‚   â”œâ”€â”€ config.py           # ì„¤ì • ê´€ë¦¬ (í™˜ê²½ ë³€ìˆ˜)
â”‚   â”œâ”€â”€ database.py         # DB ì—°ê²° ë° ì„¸ì…˜ ê´€ë¦¬
â”‚   â”œâ”€â”€ security.py         # ì¸ì¦, ì•”í˜¸í™”, JWT
â”‚   â”œâ”€â”€ exceptions.py       # ì»¤ìŠ¤í…€ ì˜ˆì™¸ í´ë˜ìŠ¤
â”‚   â”œâ”€â”€ router.py           # ì»¤ìŠ¤í…€ ë¼ìš°í„° (ê°ì‚¬, ê¶Œí•œ)
â”‚   â”œâ”€â”€ middleware.py       # ë¯¸ë“¤ì›¨ì–´ (ìš”ì²­ID, íƒ€ì´ë°)
â”‚   â””â”€â”€ dependencies.py     # FastAPI ì˜ì¡´ì„±
â”‚
â”œâ”€â”€ models/                  # SQLAlchemy ORM ëª¨ë¸
â”‚   â”œâ”€â”€ base.py             # ë² ì´ìŠ¤ ëª¨ë¸, Mixin
â”‚   â”œâ”€â”€ manager/            # ë§¤ë‹ˆì € ì‹œìŠ¤í…œ ëª¨ë¸
â”‚   â”‚   â””â”€â”€ idam/           # ì¸ì¦ & ì ‘ê·¼ ê´€ë¦¬
â”‚   â”‚       â”œâ”€â”€ user.py
â”‚   â”‚       â”œâ”€â”€ role.py
â”‚   â”‚       â”œâ”€â”€ permission.py
â”‚   â”‚       â””â”€â”€ ...
â”‚   â””â”€â”€ tenants/            # í…Œë„ŒíŠ¸ ì‹œìŠ¤í…œ ëª¨ë¸
â”‚       â”œâ”€â”€ sys/            # ì‹œìŠ¤í…œ ê´€ë¦¬
â”‚       â”œâ”€â”€ psm/            # ì¸ì‚¬ ê´€ë¦¬
â”‚       â”œâ”€â”€ ivm/            # ì¬ê³  ê´€ë¦¬
â”‚       â””â”€â”€ ...
â”‚
â”œâ”€â”€ modules/                 # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê³„ì¸µ
â”‚   â”œâ”€â”€ shareds/            # ê³µìœ  ìŠ¤í‚¤ë§ˆ ë° ì„œë¹„ìŠ¤
â”‚   â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â”‚   â””â”€â”€ response.py  # EnvelopeResponse ë“±
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚
â”‚   â”œâ”€â”€ manager/            # ë§¤ë‹ˆì € ëª¨ë“ˆ
â”‚   â”‚   â”œâ”€â”€ idam/           # ì¸ì¦ & ì ‘ê·¼ ê´€ë¦¬
â”‚   â”‚   â”‚   â”œâ”€â”€ users/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ schemas.py      # Pydantic ìŠ¤í‚¤ë§ˆ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ service.py      # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ router.py       # ì—”ë“œí¬ì¸íŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ roles/
â”‚   â”‚   â”‚   â”œâ”€â”€ permissions/
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ bill/           # ì²­êµ¬ ë° êµ¬ë…
â”‚   â”‚   â”œâ”€â”€ tnnt/           # í…Œë„ŒíŠ¸ ê´€ë¦¬
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ tenants/            # í…Œë„ŒíŠ¸ ëª¨ë“ˆ
â”‚       â”œâ”€â”€ sys/            # ì‹œìŠ¤í…œ ê´€ë¦¬
â”‚       â”œâ”€â”€ psm/            # ì¸ì‚¬ ê´€ë¦¬
â”‚       â””â”€â”€ ...
â”‚
â”œâ”€â”€ routers/                # API ë¼ìš°í„° (ì—”ë“œí¬ì¸íŠ¸ ë“±ë¡)
â”‚   â”œâ”€â”€ manager/
â”‚   â”‚   â”œâ”€â”€ v1.py          # ë§¤ë‹ˆì € v1 API í†µí•© ë¼ìš°í„°
â”‚   â”‚   â””â”€â”€ v1_full.py     # ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ í¬í•¨ ë²„ì „
â”‚   â””â”€â”€ tenants/
â”‚       â”œâ”€â”€ v1.py          # í…Œë„ŒíŠ¸ v1 API í†µí•© ë¼ìš°í„°
â”‚       â””â”€â”€ v1_full.py     # ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ í¬í•¨ ë²„ì „
â”‚
â”œâ”€â”€ utils/                  # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”‚   â””â”€â”€ auth.py            # ì¸ì¦ í—¬í¼
â”‚
â”œâ”€â”€ ai/                     # AI/LLM í†µí•© (ì„ íƒ)
â”‚   â”œâ”€â”€ agents/
â”‚   â”œâ”€â”€ chains/
â”‚   â”œâ”€â”€ embeddings/
â”‚   â”œâ”€â”€ prompts/
â”‚   â””â”€â”€ tools/
â”‚
â””â”€â”€ main.py                # FastAPI ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì 
```

### ê³„ì¸µë³„ ì±…ì„

```
HTTP ìš”ì²­
    â†“
Router (routers/)
  â”œâ”€ ê²½ë¡œ ì •ì˜
  â”œâ”€ ê¶Œí•œ ê²€ì¦
  â””â”€ HTTP ìƒíƒœì½”ë“œ ë°˜í™˜
    â†“
Service (modules/.../service.py)
  â”œâ”€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
  â”œâ”€ ê²€ì¦
  â”œâ”€ íŠ¸ëœì­ì…˜ ê´€ë¦¬
  â””â”€ ì˜ˆì™¸ ì²˜ë¦¬
    â†“
Model (models/)
  â”œâ”€ DB ì ‘ê·¼
  â”œâ”€ ORM ì¿¼ë¦¬
  â””â”€ ë°ì´í„° ì˜ì†ì„±
    â†“
Database
```

---

## í•µì‹¬ ê°œë…

### 1. Envelope Response íŒ¨í„´

ëª¨ë“  API ì‘ë‹µì€ ì¼ì •í•œ êµ¬ì¡°ë¥¼ ë”°ë¦…ë‹ˆë‹¤:

```python
# ì„±ê³µ ì‘ë‹µ
{
  "success": true,
  "data": { ... },
  "error": null
}

# ì‹¤íŒ¨ ì‘ë‹µ
{
  "success": false,
  "data": null,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "ì…ë ¥ ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨",
    "detail": { ... }
  }
}
```

### 2. ì‹œìŠ¤í…œ êµ¬ë¶„

```
ë§¤ë‹ˆì € ì‹œìŠ¤í…œ
â”œâ”€ /api/v1/manager/...
â”œâ”€ í”Œë«í¼ ìš´ì˜ (í…Œë„ŒíŠ¸ ê´€ë¦¬, ì²­êµ¬)
â””â”€ Manager DB ì‚¬ìš©

í…Œë„ŒíŠ¸ ì‹œìŠ¤í…œ
â”œâ”€ /api/v1/tenants/{tenant_id}/...
â”œâ”€ í…Œë„ŒíŠ¸ë³„ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â””â”€ í…Œë„ŒíŠ¸ë³„ DB ì‚¬ìš©
```

### 3. ëª¨ë“ˆ êµ¬ì¡°

ê° ê¸°ëŠ¥ ëª¨ë“ˆì€ ë‹¤ìŒ êµ¬ì¡°ë¥¼ ë”°ë¦…ë‹ˆë‹¤:

```
modules/manager/idam/users/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ schemas.py      # Pydantic ìš”ì²­/ì‘ë‹µ ìŠ¤í‚¤ë§ˆ
â”œâ”€â”€ service.py      # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (UserService)
â””â”€â”€ router.py       # FastAPI ë¼ìš°í„° (ì—”ë“œí¬ì¸íŠ¸)
```

# ê°œë°œ ì„œë²„ ì‹œì‘
uvicorn src.main:app --reload --port 8100
```

### ê°œë°œ ì„œë²„ ê¸°ëŠ¥

```
uvicorn src.main:app --reload --port 8100
```

- **--reload**: ì½”ë“œ ë³€ê²½ ì‹œ ìë™ ì¬ì‹œì‘
- **--port 8100**: ê¸°ë³¸ API í¬íŠ¸
- **í•« ë¦¬ë¡œë”©**: ë³€ê²½ì‚¬í•­ì´ ì¦‰ì‹œ ì ìš©ë¨
- **ëŒ€í™”ì‹ API ë¬¸ì„œ**: http://localhost:8100/docs

---

## í”„ë¡œì íŠ¸ êµ¬ì¡°

### ë””ë ‰í† ë¦¬ ì¡°ì§

```
apps/backend-api/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.py                    # ì•± ì§„ì…ì 
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ config.py              # êµ¬ì„± ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ security.py            # ì¸ì¦, ì•”í˜¸í™” ë“±
â”‚   â”‚   â””â”€â”€ dependencies.py        # FastAPI ì˜ì¡´ì„±
â”‚   â”‚
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ routers/
â”‚   â”‚   â”‚   â”œâ”€â”€ manager/           # ë§¤ë‹ˆì € ì‹œìŠ¤í…œ ë¼ìš°íŠ¸
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ idam.py        # ì‹ ì› & ì ‘ê·¼
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ tnnt.py        # í…Œë„ŒíŠ¸ ê´€ë¦¬
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ bill.py        # ì²­êµ¬
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ tenants/           # í…Œë„ŒíŠ¸ ì‹œìŠ¤í…œ ë¼ìš°íŠ¸
â”‚   â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚       â”œâ”€â”€ adm.py         # ê´€ë¦¬
â”‚   â”‚   â”‚       â”œâ”€â”€ psm.py         # ì¸ì‚¬
â”‚   â”‚   â”‚       â”œâ”€â”€ srm.py         # ë§¤ì¶œ
â”‚   â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ schemas/               # Pydantic ëª¨ë¸ (ìš”ì²­/ì‘ë‹µ)
â”‚   â”‚   â”‚   â”œâ”€â”€ manager/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ idam_schema.py
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”‚   â””â”€â”€ tenants/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ models/                # SQLAlchemy ORM ëª¨ë¸
â”‚   â”‚   â”‚   â”œâ”€â”€ manager/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ idam_model.py
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”‚   â””â”€â”€ tenants/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ services/              # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”‚   â”œâ”€â”€ manager/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ idam_service.py
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”‚   â””â”€â”€ tenants/
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ middleware/            # FastAPI ë¯¸ë“¤ì›¨ì–´
â”‚   â”‚       â”œâ”€â”€ auth.py
â”‚   â”‚       â”œâ”€â”€ cors.py
â”‚   â”‚       â”œâ”€â”€ error_handler.py
â”‚   â”‚       â””â”€â”€ logging.py
â”‚   â”‚
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€â”€ database.py            # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
â”‚   â”‚   â”œâ”€â”€ base.py                # ê¸°ë³¸ ëª¨ë¸
â”‚   â”‚   â””â”€â”€ session.py             # ì„¸ì…˜ ê´€ë¦¬
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ exceptions.py          # ì»¤ìŠ¤í…€ ì˜ˆì™¸
â”‚   â”‚   â”œâ”€â”€ logger.py              # ë¡œê¹… ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ crypto.py              # ì•”í˜¸í™” ìœ í‹¸
â”‚   â”‚   â””â”€â”€ validators.py          # ì…ë ¥ ê²€ì¦
â”‚   â”‚
â”‚   â””â”€â”€ ai/                        # AI/ML ê¸°ëŠ¥
â”‚       â”œâ”€â”€ embeddings.py
â”‚       â”œâ”€â”€ llm.py
â”‚       â””â”€â”€ rag.py
â”‚
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ unit/
â”‚   â”œâ”€â”€ integration/
â”‚   â””â”€â”€ fixtures/
â”‚
â”œâ”€â”€ alembic/                       # ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
â”‚   â”œâ”€â”€ versions/
â”‚   â””â”€â”€ env.py
â”‚
â”œâ”€â”€ pyproject.toml                 # ì˜ì¡´ì„± & ì„¤ì •
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ .env.example
â””â”€â”€ README.md
```

### ê³µì¡´ ë°°ì¹˜ íŒ¨í„´

ê° ë„ë©”ì¸ì˜ ê´€ë ¨ ì½”ë“œë¥¼ í•¨ê»˜ ê·¸ë£¹í™”:

```
# ë„ë©”ì¸: ì‚¬ìš©ì ê´€ë¦¬ (IDAM)
idam_router.py       â† HTTP ì—”ë“œí¬ì¸íŠ¸ í•¸ë“¤ëŸ¬
idam_service.py      â† ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
idam_schema.py       â† ìš”ì²­/ì‘ë‹µ ëª¨ë¸
idam_model.py        â† ë°ì´í„°ë² ì´ìŠ¤ ORM
```

**ì´ì :**
- ê´€ë ¨ ì½”ë“œë¥¼ ì°¾ê¸° ì‰¬ì›€
- ëª…í™•í•œ ì†Œìœ ê¶Œ (í•œ ì‚¬ëŒ/íŒ€ì´ ë„ë©”ì¸ ë‹´ë‹¹)
- ë…ë¦½ì  í™•ì¥
- í•„ìš”ì‹œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¡œ ì´ë™ ìš©ì´

---

## API ì„¤ê³„ ì›ì¹™

### RESTful ë¦¬ì†ŒìŠ¤ ì§€í–¥ ì„¤ê³„

```
ë¦¬ì†ŒìŠ¤: /api/v1/manager/idam/users

GET    /users              # ëª¨ë“  ì‚¬ìš©ì ë‚˜ì—´
GET    /users/:id          # íŠ¹ì • ì‚¬ìš©ì ì¡°íšŒ
POST   /users              # ìƒˆ ì‚¬ìš©ì ìƒì„±
PUT    /users/:id          # ê¸°ì¡´ ì‚¬ìš©ì ìˆ˜ì •
DELETE /users/:id          # ì‚¬ìš©ì ì‚­ì œ
```

### API URL êµ¬ì¡°

```
/api/{version}/{system}/{module}/{resource}/{id?}/{action?}

ì˜ˆ:
/api/v1/manager/idam/users
/api/v1/manager/idam/users/123
/api/v1/manager/idam/users/123/change-password
/api/v1/tenants/123/psm/employees
/api/v1/tenants/123/psm/employees/456/assignments
```

**êµ¬ì„± ìš”ì†Œ:**
- `version`: API ë²„ì „ (v1, v2) ì—­í˜¸í™˜ì„±
- `system`: manager ë˜ëŠ” tenants
- `module`: ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ (idam, tnnt, psm ë“±)
- `resource`: ì—”í‹°í‹° ìœ í˜• (users, roles, permissions)
- `id`: íŠ¹ì • ë¦¬ì†ŒìŠ¤ ì‹ë³„ì
- `action`: ì»¤ìŠ¤í…€ ì‘ì—… (change-password, approve ë“±)

### ì‘ë‹µ í¬ë§·: Envelope íŒ¨í„´

ëª¨ë“  ì‘ë‹µì€ ì´ êµ¬ì¡°ë¥¼ ë”°ë¦…ë‹ˆë‹¤:

```json
{
  "success": true,
  "data": { /* ì‹¤ì œ ë°ì´í„° */ },
  "error": null
}
```

**ì´ì :**
- ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ì—ì„œ ì¼ê´€ì„±
- ì„±ê³µ/ì‹¤íŒ¨ ëª…í™•í•œ í‘œì‹œ
- ì¤‘ì•™í™”ëœ ì—ëŸ¬ ì²˜ë¦¬
- ë©”íƒ€ë°ì´í„° ì¶”ê°€ í™•ì¥ ê°€ëŠ¥

---

## API ì—”ë“œí¬ì¸íŠ¸ êµ¬ì¶•

### ì—”ë“œí¬ì¸íŠ¸ì˜ í•´ë¶€í•™

```python
from fastapi import APIRouter, Depends, HTTPException
from sqlalchemy.orm import Session
from src.api.schemas.manager import UserCreate, UserResponse
from src.api.services.manager.idam_service import UserService
from src.db.database import get_db

router = APIRouter(prefix="/api/v1/manager/idam", tags=["IDAM ì‚¬ìš©ì"])

@router.get("/users", response_model=list[UserResponse])
async def list_users(
    skip: int = 0,                    # ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°
    limit: int = 10,
    db: Session = Depends(get_db),    # ì˜ì¡´ì„± ì£¼ì…
    current_user = Depends(require_auth)  # ì¸ì¦
):
    """
    ëª¨ë“  ì‚¬ìš©ì ë‚˜ì—´ (í˜ì´ì§€ ì²˜ë¦¬)

    - **skip**: ê±´ë„ˆë›¸ ë ˆì½”ë“œ ìˆ˜
    - **limit**: ë°˜í™˜í•  ìµœëŒ€ ë ˆì½”ë“œ ìˆ˜ (ìµœëŒ€ 100)
    """
    service = UserService(db)
    users = service.get_users(skip=skip, limit=limit)
    return users
```

**í•µì‹¬ êµ¬ì„± ìš”ì†Œ:**
1. **Router**: ê´€ë ¨ ì—”ë“œí¬ì¸íŠ¸ ê·¸ë£¹í™”
2. **íŒŒë¼ë¯¸í„°**: ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°, ê²½ë¡œ íŒŒë¼ë¯¸í„°, ë³¸ë¬¸
3. **ì˜ì¡´ì„±**: ë°ì´í„°ë² ì´ìŠ¤ ì„¸ì…˜, ì¸ì¦, ê²€ì¦
4. **ë¬¸ì„œ ë¬¸ìì—´**: API ë¬¸ì„œ
5. **ì‘ë‹µ ëª¨ë¸**: ì‘ë‹µ ê²€ì¦ìš© Pydantic ìŠ¤í‚¤ë§ˆ

### ìƒˆ ì—”ë“œí¬ì¸íŠ¸ ìƒì„±í•˜ê¸°

#### ë‹¨ê³„ 1: Pydantic ìŠ¤í‚¤ë§ˆ ì •ì˜

```python
# schemas/manager/user_schema.py
from pydantic import BaseModel, EmailStr
from datetime import datetime

class UserBase(BaseModel):
    username: str
    email: EmailStr
    is_active: bool = True

class UserCreate(UserBase):
    password: str

class UserUpdate(BaseModel):
    username: str | None = None
    email: EmailStr | None = None
    is_active: bool | None = None

class UserResponse(UserBase):
    id: int
    created_at: datetime
    updated_at: datetime

    class Config:
        from_attributes = True  # SQLAlchemy ëª¨ë¸ìš©
```

#### ë‹¨ê³„ 2: SQLAlchemy ëª¨ë¸ ì •ì˜

```python
# models/manager/user_model.py
from sqlalchemy import Column, Integer, String, Boolean, DateTime
from src.db.base import Base
import datetime as dt

class User(Base):
    __tablename__ = "users"
    __table_args__ = {"schema": "idam"}

    id = Column(Integer, primary_key=True)
    username = Column(String(50), unique=True, nullable=False)
    email = Column(String(120), unique=True, nullable=False)
    password_hash = Column(String(255), nullable=False)
    is_active = Column(Boolean, default=True)
    created_at = Column(DateTime, default=dt.datetime.utcnow)
    updated_at = Column(DateTime, default=dt.datetime.utcnow, onupdate=dt.datetime.utcnow)
```

#### ë‹¨ê³„ 3: ì„œë¹„ìŠ¤ ê³„ì¸µ êµ¬í˜„

```python
# services/manager/user_service.py
from sqlalchemy.orm import Session
from src.api.models.manager import User
from src.api.schemas.manager import UserCreate, UserUpdate
from src.utils.crypto import hash_password

class UserService:
    def __init__(self, db: Session):
        self.db = db

    def create_user(self, user_data: UserCreate) -> User:
        """í•´ì‹œëœ ë¹„ë°€ë²ˆí˜¸ë¡œ ìƒˆ ì‚¬ìš©ì ìƒì„±"""
        user = User(
            username=user_data.username,
            email=user_data.email,
            password_hash=hash_password(user_data.password)
        )
        self.db.add(user)
        self.db.commit()
        self.db.refresh(user)
        return user

    def get_user(self, user_id: int) -> User:
        """IDë¡œ ì‚¬ìš©ì ì¡°íšŒ"""
        return self.db.query(User).filter(User.id == user_id).first()

    def get_users(self, skip: int = 0, limit: int = 10) -> list[User]:
        """í˜ì´ì§€ ì²˜ë¦¬ëœ ì‚¬ìš©ì ì¡°íšŒ"""
        return self.db.query(User).offset(skip).limit(limit).all()

    def update_user(self, user_id: int, user_data: UserUpdate) -> User:
        """ì‚¬ìš©ì ìˆ˜ì •"""
        user = self.get_user(user_id)
        if not user:
            return None

        update_data = user_data.dict(exclude_unset=True)
        for field, value in update_data.items():
            setattr(user, field, value)

        self.db.commit()
        self.db.refresh(user)
        return user

    def delete_user(self, user_id: int) -> bool:
        """ì†Œí”„íŠ¸ ì‚­ì œ ì‚¬ìš©ì"""
        user = self.get_user(user_id)
        if not user:
            return False

        user.is_active = False
        self.db.commit()
        return True
```

#### ë‹¨ê³„ 4: ë¼ìš°í„° ì—”ë“œí¬ì¸íŠ¸ ìƒì„±

```python
# routers/manager/idam.py
from fastapi import APIRouter, Depends, HTTPException
from sqlalchemy.orm import Session
from src.api.schemas.manager import UserCreate, UserUpdate, UserResponse
from src.api.services.manager.user_service import UserService
from src.db.database import get_db
from src.core.security import require_auth

router = APIRouter(
    prefix="/api/v1/manager/idam",
    tags=["IDAM - ì‚¬ìš©ì"]
)

@router.post("/users", response_model=UserResponse)
async def create_user(
    user_data: UserCreate,
    db: Session = Depends(get_db),
    current_user = Depends(require_auth)
):
    """ìƒˆ ì‚¬ìš©ì ìƒì„±"""
    service = UserService(db)
    user = service.create_user(user_data)
    return user

@router.get("/users/{user_id}", response_model=UserResponse)
async def get_user(
    user_id: int,
    db: Session = Depends(get_db),
    current_user = Depends(require_auth)
):
    """IDë¡œ ì‚¬ìš©ì ì¡°íšŒ"""
    service = UserService(db)
    user = service.get_user(user_id)
    if not user:
        raise HTTPException(status_code=404, detail="ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")
    return user

@router.put("/users/{user_id}", response_model=UserResponse)
async def update_user(
    user_id: int,
    user_data: UserUpdate,
    db: Session = Depends(get_db),
    current_user = Depends(require_auth)
):
    """ì‚¬ìš©ì ìˆ˜ì •"""
    service = UserService(db)
    user = service.update_user(user_id, user_data)
    if not user:
        raise HTTPException(status_code=404, detail="ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")
    return user

@router.delete("/users/{user_id}")
async def delete_user(
    user_id: int,
    db: Session = Depends(get_db),
    current_user = Depends(require_auth)
):
    """ì‚¬ìš©ì ì‚­ì œ"""
    service = UserService(db)
    success = service.delete_user(user_id)
    if not success:
        raise HTTPException(status_code=404, detail="ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")
    return {"message": "ì‚¬ìš©ìê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤"}
```

#### ë‹¨ê³„ 5: ë©”ì¸ ì•±ì— ë¼ìš°í„° ë“±ë¡

```python
# src/main.py
from fastapi import FastAPI
from src.api.routers.manager import idam

app = FastAPI(title="CXG API")

# ë¼ìš°í„° ë“±ë¡
app.include_router(idam.router)
```

---

## ì¸ì¦ ë° ê¶Œí•œ

### JWT í† í° íë¦„

```python
from fastapi import APIRouter, Depends, HTTPException
from fastapi.security import HTTPBearer, HTTPAuthenticationCredentials
import jwt
from datetime import datetime, timedelta

security = HTTPBearer()

def create_tokens(user_id: int, tenant_id: int):
    """ì ‘ê·¼ ë° ìƒˆë¡œê³ ì¹¨ í† í° ìƒì„±"""

    # ì ‘ê·¼ í† í° (15ë¶„)
    access_payload = {
        "sub": str(user_id),
        "tenant_id": tenant_id,
        "type": "access",
        "exp": datetime.utcnow() + timedelta(minutes=15)
    }
    access_token = jwt.encode(access_payload, SECRET_KEY, algorithm="HS256")

    # ìƒˆë¡œê³ ì¹¨ í† í° (7ì¼)
    refresh_payload = {
        "sub": str(user_id),
        "tenant_id": tenant_id,
        "type": "refresh",
        "exp": datetime.utcnow() + timedelta(days=7)
    }
    refresh_token = jwt.encode(refresh_payload, SECRET_KEY, algorithm="HS256")

    return access_token, refresh_token

async def require_auth(credentials: HTTPAuthenticationCredentials = Depends(security)):
    """JWT í† í° ê²€ì¦"""
    try:
        payload = jwt.decode(credentials.credentials, SECRET_KEY, algorithms=["HS256"])
        user_id: str = payload.get("sub")
        if user_id is None:
            raise HTTPException(status_code=401, detail="ì˜ëª»ëœ í† í°ì…ë‹ˆë‹¤")
    except jwt.InvalidTokenError:
        raise HTTPException(status_code=401, detail="ì˜ëª»ëœ í† í°ì…ë‹ˆë‹¤")

    return {"user_id": int(user_id), "tenant_id": payload.get("tenant_id")}
```

### ê¶Œí•œ ê²€ì‚¬

```python
async def check_permission(required_permission: str):
    """ì‚¬ìš©ìê°€ íŠ¹ì • ê¶Œí•œì„ ê°€ì§€ê³  ìˆëŠ”ì§€ í™•ì¸"""
    async def _check(current_user = Depends(require_auth)):
        # ì‚¬ìš©ìì˜ ì—­í•  ë¡œë“œ
        user_roles = db.query(UserRole).filter(
            UserRole.user_id == current_user["user_id"]
        ).all()

        # í•´ë‹¹ ì—­í• ì˜ ê¶Œí•œ ë¡œë“œ
        permissions = []
        for role in user_roles:
            role_perms = db.query(Permission).join(RolePermission).filter(
                RolePermission.role_id == role.role_id
            ).all()
            permissions.extend([p.code for p in role_perms])

        # í•„ìš”í•œ ê¶Œí•œ í™•ì¸
        if required_permission not in permissions:
            raise HTTPException(status_code=403, detail="ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤")

        return current_user

    return _check

# ì‚¬ìš© ì˜ˆ
@router.delete("/users/{user_id}")
async def delete_user(
    user_id: int,
    db: Session = Depends(get_db),
    current_user = Depends(check_permission("idam:user:delete"))
):
    """ì‚¬ìš©ì ì‚­ì œ (idam:user:delete ê¶Œí•œ í•„ìš”)"""
    # êµ¬í˜„
```

---

## ì—ëŸ¬ ì²˜ë¦¬

### ì˜ˆì™¸ í´ë˜ìŠ¤

```python
# utils/exceptions.py
class APIException(Exception):
    """ê¸°ë³¸ API ì˜ˆì™¸"""
    def __init__(self, status_code: int, message: str, details: dict = None):
        self.status_code = status_code
        self.message = message
        self.details = details or {}

class NotFoundError(APIException):
    def __init__(self, resource: str):
        super().__init__(404, f"{resource}ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")

class ValidationError(APIException):
    def __init__(self, message: str, details: dict = None):
        super().__init__(400, message, details)

class UnauthorizedError(APIException):
    def __init__(self, message: str = "ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤"):
        super().__init__(401, message)

class ForbiddenError(APIException):
    def __init__(self, message: str = "ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤"):
        super().__init__(403, message)
```

### ì—ëŸ¬ í•¸ë“¤ëŸ¬ ë¯¸ë“¤ì›¨ì–´

```python
# middleware/error_handler.py
from fastapi import Request
from fastapi.responses import JSONResponse
from src.utils.exceptions import APIException

@app.exception_handler(APIException)
async def api_exception_handler(request: Request, exc: APIException):
    return JSONResponse(
        status_code=exc.status_code,
        content={
            "success": False,
            "data": None,
            "error": {
                "code": exc.__class__.__name__,
                "message": exc.message,
                "details": exc.details
            }
        }
    )

@app.exception_handler(Exception)
async def general_exception_handler(request: Request, exc: Exception):
    """ì˜ˆê¸°ì¹˜ ì•Šì€ ì˜¤ë¥˜ ì²˜ë¦¬"""
    logger.error(f"ì˜ˆìƒ ë°–ì˜ ì˜¤ë¥˜: {exc}", exc_info=True)
    return JSONResponse(
        status_code=500,
        content={
            "success": False,
            "data": None,
            "error": {
                "code": "INTERNAL_ERROR",
                "message": "ë‚´ë¶€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"
            }
        }
    )
```

---

## ë°ì´í„° ê²€ì¦

### Pydantic ê²€ì¦ì

```python
from pydantic import BaseModel, field_validator, Field

class UserCreate(BaseModel):
    username: str = Field(..., min_length=3, max_length=50)
    email: str
    password: str = Field(..., min_length=8)

    @field_validator('username')
    @classmethod
    def username_alphanumeric(cls, v):
        if not v.isalnum():
            raise ValueError('ì•ŒíŒŒë²³ê³¼ ìˆ«ìë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤')
        return v

    @field_validator('password')
    @classmethod
    def password_strong(cls, v):
        if not any(c.isupper() for c in v):
            raise ValueError('ëŒ€ë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤')
        if not any(c.isdigit() for c in v):
            raise ValueError('ìˆ«ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤')
        return v
```

---

## ë°ì´í„°ë² ì´ìŠ¤ í†µí•©

### ì¿¼ë¦¬ íŒ¨í„´

```python
# í•„í„°ë§ê³¼ í•¨ê»˜ ì„ íƒ
users = db.query(User).filter(User.is_active == True).all()

# ì¡°ì¸ê³¼ í•¨ê»˜ ì„ íƒ
users_with_roles = db.query(User).join(UserRole).filter(
    UserRole.role_id == 1
).all()

# ì •ë ¬ ë° í˜ì´ì§€ ì²˜ë¦¬
users = db.query(User).order_by(User.created_at.desc()).offset(10).limit(20).all()

# ì§‘ê³„ í•¨ìˆ˜
user_count = db.query(User).count()
active_count = db.query(User).filter(User.is_active == True).count()

# ê·¸ë£¹í™”
from sqlalchemy import func
counts = db.query(User.role_id, func.count(User.id)).group_by(User.role_id).all()
```

### íŠ¸ëœì­ì…˜

```python
def transfer_data(from_id: int, to_id: int, db: Session):
    try:
        # í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì—ì„œ ì—¬ëŸ¬ ì‘ì—…
        user1 = db.query(User).filter(User.id == from_id).first()
        user2 = db.query(User).filter(User.id == to_id).first()

        user1.balance -= 100
        user2.balance += 100

        db.commit()  # ëª¨ë‘ í•¨ê»˜ ì„±ê³µ
    except Exception as e:
        db.rollback()  # ì˜¤ë¥˜ ë°œìƒ ì‹œ ëª¨ë‘ ë¡¤ë°±
        raise
```

### ë§ˆì´ê·¸ë ˆì´ì…˜

```bash
# ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ìƒì„±
alembic revision --autogenerate -m "ì‚¬ìš©ì ì—­í•  í…Œì´ë¸” ì¶”ê°€"

# alembic/versions/ì—ì„œ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ê²€í† 

# ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš©
alembic upgrade head

# í•œ ë§ˆì´ê·¸ë ˆì´ì…˜ ë¡¤ë°±
alembic downgrade -1

# ëª¨ë‘ ë¡¤ë°±
alembic downgrade base
```

---

## ì½”ë“œ í’ˆì§ˆ ë° í…ŒìŠ¤íŒ…

### ë¦°íŒ… & íƒ€ì… ê²€ì‚¬

```bash
# ruffë¡œ ì½”ë“œ ë¦°íŒ…
ruff check src/

# ë¦°íŒ… ë¬¸ì œ ìë™ ìˆ˜ì •
ruff check src/ --fix

# ì½”ë“œ í¬ë§·
ruff format src/

# mypyë¡œ íƒ€ì… ê²€ì‚¬
mypy src/

# ëª¨ë‘ í•¨ê»˜
ruff check src/ --fix && ruff format src/ && mypy src/
```

### í…ŒìŠ¤íŠ¸ ì‘ì„±

```python
# tests/unit/test_user_service.py
import pytest
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
from src.api.models.manager import User, Base
from src.api.services.manager.user_service import UserService
from src.api.schemas.manager import UserCreate

@pytest.fixture
def db():
    """í…ŒìŠ¤íŒ…ìš© ë©”ëª¨ë¦¬ ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±"""
    engine = create_engine("sqlite:///:memory:")
    Base.metadata.create_all(engine)
    Session = sessionmaker(bind=engine)
    yield Session()

def test_create_user(db):
    """ì‚¬ìš©ì ìƒì„± í…ŒìŠ¤íŠ¸"""
    service = UserService(db)
    user_data = UserCreate(
        username="john",
        email="john@example.com",
        password="SecurePass123"
    )

    user = service.create_user(user_data)

    assert user.id is not None
    assert user.username == "john"
    assert user.email == "john@example.com"

def test_get_user(db):
    """ì‚¬ìš©ì ê²€ìƒ‰ í…ŒìŠ¤íŠ¸"""
    # ì„¤ì •
    user = User(username="john", email="john@example.com", password_hash="hash")
    db.add(user)
    db.commit()

    # í…ŒìŠ¤íŠ¸
    service = UserService(db)
    retrieved = service.get_user(user.id)

    assert retrieved.username == "john"

def test_delete_user(db):
    """ì‚¬ìš©ì ì‚­ì œ í…ŒìŠ¤íŠ¸"""
    # ì„¤ì •
    user = User(username="john", email="john@example.com", password_hash="hash")
    db.add(user)
    db.commit()

    # í…ŒìŠ¤íŠ¸
    service = UserService(db)
    service.delete_user(user.id)

    retrieved = service.get_user(user.id)
    assert not retrieved.is_active
```

### í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```bash
# ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰
pytest tests/

# íŠ¹ì • í…ŒìŠ¤íŠ¸ íŒŒì¼ ì‹¤í–‰
pytest tests/unit/test_user_service.py

# ì»¤ë²„ë¦¬ì§€ í¬í•¨ ì‹¤í–‰
pytest --cov=src/ tests/

# ìƒì„¸ ì¶œë ¥ìœ¼ë¡œ ì‹¤í–‰
pytest -v tests/

# ì²« ë²ˆì§¸ ì‹¤íŒ¨ ì‹œ ì¤‘ì§€
pytest -x tests/
```

---

## ì„±ëŠ¥ ë° ìµœì í™”

### ì¿¼ë¦¬ ìµœì í™”

```python
# ë‚˜ìœ ì˜ˆ: N+1 ë¬¸ì œ (ê° ì‚¬ìš©ìë§ˆë‹¤ ì—­í•  ì¡°íšŒ)
users = db.query(User).all()
for user in users:
    print(user.roles)  # ì‚¬ìš©ìë‹¹ ì¶”ê°€ ì¿¼ë¦¬!

# ì¢‹ì€ ì˜ˆ: ì¦‰ì‹œ ë¡œë”©
from sqlalchemy.orm import joinedload
users = db.query(User).options(joinedload(User.roles)).all()

# ì¢‹ì€ ì˜ˆ: ëª…ì‹œì  ì¡°ì¸
users = db.query(User).join(User.roles).all()
```

### ìºì‹±

```python
from functools import lru_cache
import redis

redis_client = redis.Redis(host='localhost', port=6379)

def get_user_cached(user_id: int):
    # ë¨¼ì € ìºì‹œ í™•ì¸
    cached = redis_client.get(f"user:{user_id}")
    if cached:
        return json.loads(cached)

    # DBì—ì„œ ê°€ì ¸ì˜¤ê¸°
    user = db.query(User).filter(User.id == user_id).first()

    # 1ì‹œê°„ ë™ì•ˆ ìºì‹œì— ì €ì¥
    redis_client.setex(f"user:{user_id}", 3600, json.dumps(user_dict))

    return user
```

### í˜ì´ì§€ ì²˜ë¦¬

```python
# í•­ìƒ í° ê²°ê³¼ ì§‘í•©ì„ í˜ì´ì§€ ì²˜ë¦¬
@router.get("/users")
def list_users(
    page: int = 1,
    per_page: int = 20,
    db: Session = Depends(get_db)
):
    skip = (page - 1) * per_page

    total = db.query(User).count()
    items = db.query(User).offset(skip).limit(per_page).all()

    return {
        "items": items,
        "total": total,
        "page": page,
        "per_page": per_page,
        "total_pages": (total + per_page - 1) // per_page
    }
```

---

## API ì—”ë“œí¬ì¸íŠ¸ ì°¸ê³ 

### ë§¤ë‹ˆì € ì‹œìŠ¤í…œ ì—”ë“œí¬ì¸íŠ¸

**ì¸ì¦ (IDAM)**
```
POST   /api/v1/manager/idam/login
POST   /api/v1/manager/idam/refresh-token
POST   /api/v1/manager/idam/logout
GET    /api/v1/manager/idam/me
```

**ì‚¬ìš©ì ê´€ë¦¬**
```
GET    /api/v1/manager/idam/users
POST   /api/v1/manager/idam/users
GET    /api/v1/manager/idam/users/:id
PUT    /api/v1/manager/idam/users/:id
DELETE /api/v1/manager/idam/users/:id
```

**ì—­í•  ê´€ë¦¬**
```
GET    /api/v1/manager/idam/roles
POST   /api/v1/manager/idam/roles
GET    /api/v1/manager/idam/roles/:id
PUT    /api/v1/manager/idam/roles/:id
DELETE /api/v1/manager/idam/roles/:id
```

**í…Œë„ŒíŠ¸ ê´€ë¦¬**
```
GET    /api/v1/manager/tnnt/tenants
POST   /api/v1/manager/tnnt/tenants
GET    /api/v1/manager/tnnt/tenants/:id
PUT    /api/v1/manager/tnnt/tenants/:id
DELETE /api/v1/manager/tnnt/tenants/:id
```

### í…Œë„ŒíŠ¸ ì‹œìŠ¤í…œ ì—”ë“œí¬ì¸íŠ¸

ëª¨ë“  í…Œë„ŒíŠ¸ ì—”ë“œí¬ì¸íŠ¸ì—ëŠ” URLì— `tenant_id` í•„ìš”:

```
GET    /api/v1/tenants/:tenant_id/adm/users
POST   /api/v1/tenants/:tenant_id/adm/users
GET    /api/v1/tenants/:tenant_id/psm/employees
POST   /api/v1/tenants/:tenant_id/psm/employees
GET    /api/v1/tenants/:tenant_id/srm/orders
POST   /api/v1/tenants/:tenant_id/srm/orders
```

---

## ë¬¸ì œ í•´ê²°

### ì¼ë°˜ì ì¸ ë¬¸ì œ

**ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì˜¤ë¥˜**
```
ì˜¤ë¥˜: ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤
í•´ê²°ì±…: .envì˜ DATABASE_URL í™•ì¸, PostgreSQL ì‹¤í–‰ ì¤‘ í™•ì¸
```

**í¬íŠ¸ê°€ ì´ë¯¸ ì‚¬ìš© ì¤‘**
```
ì˜¤ë¥˜: ì£¼ì†Œê°€ ì´ë¯¸ ì‚¬ìš© ì¤‘ì…ë‹ˆë‹¤
í•´ê²°ì±…: uvicorn src.main:app --reload --port 8101
```

**ë§ˆì´ê·¸ë ˆì´ì…˜ ì¶©ëŒ**
```
ì˜¤ë¥˜: ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš© ì‹œ Alembic ì¶©ëŒ
í•´ê²°ì±…: alembic/versions/ë¥¼ ìˆ˜ë™ìœ¼ë¡œ í™•ì¸í•˜ê³  ì¶©ëŒ í•´ê²°
```

**ì„í¬íŠ¸ ì˜¤ë¥˜**
```
ì˜¤ë¥˜: ModuleNotFoundError: 'src' ëª¨ë“ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤
í•´ê²°ì±…: PYTHONPATHê°€ í”„ë¡œì íŠ¸ ë£¨íŠ¸ë¥¼ í¬í•¨í•˜ëŠ”ì§€ í™•ì¸
```

---

ë” ìì„¸í•œ ì •ë³´ëŠ” ë‹¤ìŒì„ ì°¸ì¡°í•˜ì„¸ìš”:
- [ì¸ì¦ ì „ëµ](./02_ë©€í‹°í…Œë„ŒíŠ¸_ì¸ì¦ì „ëµ_20241108.md)
- [API ëª…ì„¸](./09-API-SPECIFICATION.md)
- [API ë¼ìš°íŒ…](./API_ROUTING.md)
- [ë°ì´í„°ë² ì´ìŠ¤ ê°€ì´ë“œ](../03_database/START_HERE.md)

**ê°œë°œì„ ì¦ê¸°ì„¸ìš”! ğŸš€**
